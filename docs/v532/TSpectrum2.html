<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!--                                             -->
<!-- Author: ROOT team (rootdev@pcroot.cern.ch)  -->
<!--                                             -->
<!--   Date: Thu Nov  3 20:23:05 2011            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>TSpectrum2</title>
<meta name="rating" content="General" />
<meta name="objecttype" content="Manual" />
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers, cern" />
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis." />
<link rel="stylesheet" type="text/css" href="ROOT.css" id="ROOTstyle" />
<script type="text/javascript" src="ROOT.js"></script>
</head>
<body  onload="javascript:SetValuesFromCookie();"><div id="body_content">
<div id="root_header"><img src="http://root.cern.ch/drupal/sites/default/files/rootdrawing-logo.png" alt="ROOT logo"/></div>
<a name="TopOfPage"></a>
<script type="text/javascript">WriteFollowPageBox('class TSpectrum2','libSpectrum','TSpectrum2.h');</script>
<div id="toplinks">
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Quick Links:</span>
<a class="descrheadentry" href="http://root.cern.ch">ROOT Homepage</a>
<a class="descrheadentry" href="./ClassIndex.html">Class Index</a>
<a class="descrheadentry" href="./ClassHierarchy.html">Class Hierarchy</a></div>
<script type="text/javascript">
function onSearch() {
var s='http://www.google.com/search?q=%s+site%3A%u+-site%3A%u%2Fsrc%2F+-site%3A%u%2Fexamples%2F';
var ref=String(document.location.href).replace(/https?:\/\//,'').replace(/\/[^\/]*$/,'').replace(/\//g,'%2F');
window.location.href=s.replace(/%u/ig,ref).replace(/%s/ig,escape(document.searchform.t.value));
return false;}
</script>
<form id="searchform" name="searchform" onsubmit="return onSearch()" action="javascript:onSearch();" method="post">
<input name="t" size="30" value="Search documentation..." onfocus="if (document.searchform.t.value=='Search documentation...') document.searchform.t.value='';"></input>
<a id="searchlink"  title="www.google.com"  href="javascript:onSearch();" onclick="return onSearch()">Search</a></form>
</div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Source:</span>
<a class="descrheadentry" href="src/TSpectrum2.h.html">header file</a>
<a class="descrheadentry" href="src/TSpectrum2.cxx.html">source file</a>
<a class="descrheadentry" href="http://root.cern.ch/viewcvs/trunk/hist/spectrum/inc/TSpectrum2.h?view=log">viewVC header</a> <a class="descrheadentry" href="http://root.cern.ch/viewcvs/trunk/hist/spectrum/src/TSpectrum2.cxx?view=log">viewVC source</a> 
</div></div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Sections:</span>
<a class="descrheadentry" href="#TSpectrum2:description">class description</a> 
<a class="descrheadentry" href="#TSpectrum2:Function_Members">function members</a>
<a class="descrheadentry" href="#TSpectrum2:Data_Members">data members</a>
<a class="descrheadentry" href="#TSpectrum2:Class_Charts">class charts</a>
</div></div>
</div>
<div class="location">
<a class="locationlevel" href="index.html">ROOT</a>
 &#187; <a class="locationlevel" href="./HIST_Index.html">HIST</a>
 &#187; <a class="locationlevel" href="./HIST_SPECTRUM_Index.html">SPECTRUM</a>
 &#187; <a class="locationlevel" href="#TopOfPage">TSpectrum2</a>
</div>
<div class="dropshadow"><div class="withshadow"><h1><a name="TSpectrum2:description"></a>class TSpectrum2: public <a href="./TNamed.html">TNamed</a></h1>
<div class="classdescr">
<pre>
THIS CLASS CONTAINS ADVANCED SPECTRA PROCESSING FUNCTIONS.

ONE-DIMENSIONAL BACKGROUND ESTIMATION FUNCTIONS
TWO-DIMENSIONAL BACKGROUND ESTIMATION FUNCTIONS
ONE-DIMENSIONAL SMOOTHING FUNCTIONS
TWO-DIMENSIONAL SMOOTHING FUNCTIONS
ONE-DIMENSIONAL DECONVOLUTION FUNCTIONS
TWO-DIMENSIONAL DECONVOLUTION FUNCTIONS
ONE-DIMENSIONAL PEAK SEARCH FUNCTIONS
TWO-DIMENSIONAL PEAK SEARCH FUNCTIONS

These functions were written by:
Miroslav Morhac
Institute of Physics
Slovak Academy of Sciences
Dubravska cesta 9, 842 28 BRATISLAVA
SLOVAKIA

email:fyzimiro@savba.sk,    fax:+421 7 54772479

The original code in C has been repackaged as a C++ class by R.Brun

The algorithms in this class have been published in the following
references:
[1]  M.Morhac et al.: <a href="./TSpectrum2.html#TSpectrum2:Background" title="TH1* TSpectrum2::Background(const TH1* hist,int niter=20,Option_t* option=&quot;&quot;) or overloads">Background</a> elimination methods for
multidimensional coincidence gamma-ray spectra. Nuclear
Instruments and Methods in Physics Research A 401 (1997) 113-
132.

[2]  M.Morhac et al.: Efficient one- and two-dimensional Gold
deconvolution and its application to gamma-ray spectra
decomposition. Nuclear Instruments and Methods in Physics
Research A 401 (1997) 385-408.

[3]  M.Morhac et al.: Identification of peaks in multidimensional
coincidence gamma-ray spectra. Nuclear Instruments and Methods in
Research Physics A  443(2000), 108-125.

These NIM papers are also available as Postscript files from:


   ftp://root.cern.ch/root/SpectrumDec.ps.gz
   ftp://root.cern.ch/root/SpectrumSrc.ps.gz
   ftp://root.cern.ch/root/SpectrumBck.ps.gz




NEW FUNCTIONS  January 2006

</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal style='text-align:justify'><i><span lang=EN-US
style='font-size:16.0pt'>All figures in this page were prepared using DaqProVis
system, Data Acquisition, Processing and Visualization system, which is being
developed at the Institute of Physics, Slovak Academy of Sciences, Bratislava,
Slovakia:  </span></i></p>
<p class=MsoNormal style='text-align:justify'><i><span lang=EN-US
style='font-size:16.0pt'><a href="http://www.fu.sav.sk/nph/projects/DaqProVis/">http://www.fu.sav.sk/nph/projects/DaqProVis/</a>
under construction</span></i></p>
<p class=MsoNormal style='text-align:justify'><i><span lang=EN-US
style='font-size:16.0pt'><a href="http://www.fu.sav.sk/nph/projects/ProcFunc/">http://www.fu.sav.sk/nph/projects/ProcFunc/</a>
.</span></i></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div></div>

<div id="functions">
<h2><a id="TSpectrum2:Function_Members"></a>Function Members (Methods)</h2>
<div class="access" id="funcpubl"><b>public:</b>
<table class="func" id="tabfuncpubl" cellspacing="0">
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum2:TSpectrum2">TSpectrum2</a>()</td></tr>
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum2:TSpectrum2%2">TSpectrum2</a>(<span class="keyword">const</span> <a href="./TSpectrum2.html">TSpectrum2</a>&amp;)</td></tr>
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum2:TSpectrum2%1">TSpectrum2</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> maxpositions, <a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</td></tr>
<tr class="func"><td class="funcret"> virtual</td><td class="funcname"><a class="funcname" href="#TSpectrum2:_TSpectrum2">~TSpectrum2</a>()</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:AbstractMethod"><span class="baseclass">TObject::</span>AbstractMethod</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:AppendPad"><span class="baseclass">TObject::</span>AppendPad</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret">virtual <a href="./TH1.html">TH1</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:Background">Background</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <span class="keyword">int</span> niter = 20, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:Background%1">Background</a>(<span class="keyword">float</span>** spectrum, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsX, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsY, <a href="./ListOfTypes.html#Int_t">Int_t</a> direction, <a href="./ListOfTypes.html#Int_t">Int_t</a> filterType)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Browse"><span class="baseclass">TObject::</span>Browse</a>(<a href="./TBrowser.html">TBrowser</a>* b)</td></tr>
<tr class="func"><td class="funcret">static <a href="./TClass.html">TClass</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:Class">Class</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ClassName"><span class="baseclass">TObject::</span>ClassName</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Clear"><span class="baseclass">TNamed::</span>Clear</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Clone"><span class="baseclass">TNamed::</span>Clone</a>(<span class="keyword">const</span> <span class="keyword">char</span>* newname = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Compare"><span class="baseclass">TNamed::</span>Compare</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Copy"><span class="baseclass">TNamed::</span>Copy</a>(<a href="./TObject.html">TObject</a>&amp; named) <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:Deconvolution">Deconvolution</a>(<span class="keyword">float</span>** source, <span class="keyword">float</span>** resp, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterations, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberRepetitions, <a href="./ListOfTypes.html#Double_t">Double_t</a> boost)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Delete"><span class="baseclass">TObject::</span>Delete</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DistancetoPrimitive"><span class="baseclass">TObject::</span>DistancetoPrimitive</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Draw"><span class="baseclass">TObject::</span>Draw</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DrawClass"><span class="baseclass">TObject::</span>DrawClass</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DrawClone"><span class="baseclass">TObject::</span>DrawClone</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Dump"><span class="baseclass">TObject::</span>Dump</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Error"><span class="baseclass">TObject::</span>Error</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Execute"><span class="baseclass">TObject::</span>Execute</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* params, <a href="./ListOfTypes.html#Int_t">Int_t</a>* error = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Execute%1"><span class="baseclass">TObject::</span>Execute</a>(<a href="./TMethod.html">TMethod</a>* method, <a href="./TObjArray.html">TObjArray</a>* params, <a href="./ListOfTypes.html#Int_t">Int_t</a>* error = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ExecuteEvent"><span class="baseclass">TObject::</span>ExecuteEvent</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> event, <a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Fatal"><span class="baseclass">TObject::</span>Fatal</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:FillBuffer"><span class="baseclass">TNamed::</span>FillBuffer</a>(<span class="keyword">char</span>*&amp; buffer)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:FindObject"><span class="baseclass">TObject::</span>FindObject</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:FindObject%1"><span class="baseclass">TObject::</span>FindObject</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Option_t">Option_t</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetDrawOption"><span class="baseclass">TObject::</span>GetDrawOption</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <a href="./ListOfTypes.html#Long_t">Long_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetDtorOnly"><span class="baseclass">TObject::</span>GetDtorOnly</a>()</td></tr>
<tr class="func"><td class="funcret"><a href="./TH1.html">TH1</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:GetHistogram">GetHistogram</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetIconName"><span class="baseclass">TObject::</span>GetIconName</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:GetName"><span class="baseclass">TNamed::</span>GetName</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum2:GetNPeaks">GetNPeaks</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetObjectInfo"><span class="baseclass">TObject::</span>GetObjectInfo</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetObjectStat"><span class="baseclass">TObject::</span>GetObjectStat</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Option_t">Option_t</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetOption"><span class="baseclass">TObject::</span>GetOption</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:GetPositionX">GetPositionX</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:GetPositionY">GetPositionY</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:GetTitle"><span class="baseclass">TNamed::</span>GetTitle</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#UInt_t">UInt_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetUniqueID"><span class="baseclass">TObject::</span>GetUniqueID</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:HandleTimer"><span class="baseclass">TObject::</span>HandleTimer</a>(<a href="./TTimer.html">TTimer</a>* timer)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#ULong_t">ULong_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Hash"><span class="baseclass">TNamed::</span>Hash</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Info"><span class="baseclass">TObject::</span>Info</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InheritsFrom"><span class="baseclass">TObject::</span>InheritsFrom</a>(<span class="keyword">const</span> <span class="keyword">char</span>* classname) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InheritsFrom%1"><span class="baseclass">TObject::</span>InheritsFrom</a>(<span class="keyword">const</span> <a href="./TClass.html">TClass</a>* cl) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Inspect"><span class="baseclass">TObject::</span>Inspect</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InvertBit"><span class="baseclass">TObject::</span>InvertBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="func"><td class="funcret">virtual <a href="./TClass.html">TClass</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:IsA">IsA</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsEqual"><span class="baseclass">TObject::</span>IsEqual</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsFolder"><span class="baseclass">TObject::</span>IsFolder</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsOnHeap"><span class="baseclass">TObject::</span>IsOnHeap</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:IsSortable"><span class="baseclass">TNamed::</span>IsSortable</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsZombie"><span class="baseclass">TObject::</span>IsZombie</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:ls"><span class="baseclass">TNamed::</span>ls</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:MayNotUse"><span class="baseclass">TObject::</span>MayNotUse</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Notify"><span class="baseclass">TObject::</span>Notify</a>()</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Obsolete"><span class="baseclass">TObject::</span>Obsolete</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* asOfVers, <span class="keyword">const</span> <span class="keyword">char</span>* removedFromVers) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete"><span class="baseclass">TObject::</span>operator delete</a>(<span class="keyword">void</span>* ptr)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete%1"><span class="baseclass">TObject::</span>operator delete</a>(<span class="keyword">void</span>* ptr, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete[]"><span class="baseclass">TObject::</span>operator delete[]</a>(<span class="keyword">void</span>* ptr)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete[]%1"><span class="baseclass">TObject::</span>operator delete[]</a>(<span class="keyword">void</span>* ptr, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new"><span class="baseclass">TObject::</span>operator new</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new%1"><span class="baseclass">TObject::</span>operator new</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new[]"><span class="baseclass">TObject::</span>operator new[]</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new[]%1"><span class="baseclass">TObject::</span>operator new[]</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz, <span class="keyword">void</span>* vp)</td></tr>
<tr class="func"><td class="funcret"><a href="./TSpectrum2.html">TSpectrum2</a>&amp;</td><td class="funcname"><a class="funcname" href="#TSpectrum2:operator_">operator=</a>(<span class="keyword">const</span> <a href="./TSpectrum2.html">TSpectrum2</a>&amp;)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Paint"><span class="baseclass">TObject::</span>Paint</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Pop"><span class="baseclass">TObject::</span>Pop</a>()</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:Print">Print</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Read"><span class="baseclass">TObject::</span>Read</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:RecursiveRemove"><span class="baseclass">TObject::</span>RecursiveRemove</a>(<a href="./TObject.html">TObject</a>* obj)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ResetBit"><span class="baseclass">TObject::</span>ResetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SaveAs"><span class="baseclass">TObject::</span>SaveAs</a>(<span class="keyword">const</span> <span class="keyword">char</span>* filename = <span class="string">""</span>, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SavePrimitive"><span class="baseclass">TObject::</span>SavePrimitive</a>(<a href="./ListOfTypes.html#ostream">ostream</a>&amp; out, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum2:Search">Search</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum2:SearchHighRes">SearchHighRes</a>(<span class="keyword">float</span>** source, <span class="keyword">float</span>** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> backgroundRemove, <a href="./ListOfTypes.html#Int_t">Int_t</a> deconIterations, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</td></tr>
<tr class="func"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:SetAverageWindow">SetAverageWindow</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> w = 3)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetBit%1"><span class="baseclass">TObject::</span>SetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetBit"><span class="baseclass">TObject::</span>SetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> set)</td></tr>
<tr class="func"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:SetDeconIterations">SetDeconIterations</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> n = 3)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetDrawOption"><span class="baseclass">TObject::</span>SetDrawOption</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetDtorOnly"><span class="baseclass">TObject::</span>SetDtorOnly</a>(<span class="keyword">void</span>* obj)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetName"><span class="baseclass">TNamed::</span>SetName</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetNameTitle"><span class="baseclass">TNamed::</span>SetNameTitle</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">const</span> <span class="keyword">char</span>* title)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetObjectStat"><span class="baseclass">TObject::</span>SetObjectStat</a>(<a href="./ListOfTypes.html#Bool_t">Bool_t</a> stat)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:SetResolution">SetResolution</a>(<a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetTitle"><span class="baseclass">TNamed::</span>SetTitle</a>(<span class="keyword">const</span> <span class="keyword">char</span>* title = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetUniqueID"><span class="baseclass">TObject::</span>SetUniqueID</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> uid)</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:ShowMembers">ShowMembers</a>(<a href="./TMemberInspector.html">TMemberInspector</a>&amp; insp)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Sizeof"><span class="baseclass">TNamed::</span>Sizeof</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:SmoothMarkov">SmoothMarkov</a>(<span class="keyword">float</span>** source, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</td></tr>
<tr class="func"><td class="funcret">static <a href="./TH1.html">TH1</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum2:StaticBackground">StaticBackground</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Int_t">Int_t</a> niter = 20, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret">static <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum2:StaticSearch">StaticSearch</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:Streamer">Streamer</a>(<a href="./TBuffer.html">TBuffer</a>&amp; b)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum2:StreamerNVirtual">StreamerNVirtual</a>(<a href="./TBuffer.html">TBuffer</a>&amp; b)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SysError"><span class="baseclass">TObject::</span>SysError</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:TestBit"><span class="baseclass">TObject::</span>TestBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:TestBits"><span class="baseclass">TObject::</span>TestBits</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:UseCurrentStyle"><span class="baseclass">TObject::</span>UseCurrentStyle</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Warning"><span class="baseclass">TObject::</span>Warning</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Write"><span class="baseclass">TObject::</span>Write</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> option = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> bufsize = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Write%1"><span class="baseclass">TObject::</span>Write</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> option = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> bufsize = 0) <span class="keyword">const</span></td></tr>

</table></div>
<div class="access" id="funcprot"><b>protected:</b>
<table class="func" id="tabfuncprot" cellspacing="0">
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DoError"><span class="baseclass">TObject::</span>DoError</a>(<span class="keyword">int</span> level, <span class="keyword">const</span> <span class="keyword">char</span>* location, <span class="keyword">const</span> <span class="keyword">char</span>* fmt, va_list va) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:MakeZombie"><span class="baseclass">TObject::</span>MakeZombie</a>()</td></tr>

</table></div>
</div>

<div id="datamembers">
<h2><a name="TSpectrum2:Data_Members"></a>Data Members</h2>
<div class="access" id="enumpubl"><b>public:</b>
<table class="data" id="tabenumpubl" cellspacing="0">
<tr class="data"><td class="datatype">enum  { </td><td class="dataname"><a name="TSpectrum2:kBackIncreasingWindow"></a>kBackIncreasingWindow</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum2:kBackDecreasingWindow"></a>kBackDecreasingWindow</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum2:kBackSuccessiveFiltering"></a>kBackSuccessiveFiltering</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum2:kBackOneStepFiltering"></a>kBackOneStepFiltering</td><td></td></tr>
<tr class="data"><td class="datatype">};</td><td></td><td></td></tr>
<tr class="datainh"><td class="datatype">enum <span class="baseclass">TObject::</span>EStatusBits { </td><td class="dataname"><a href="./TObject.html#TObject:kCanDelete">kCanDelete</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kMustCleanup">kMustCleanup</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kObjInCanvas">kObjInCanvas</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kIsReferenced">kIsReferenced</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kHasUUID">kHasUUID</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kCannotPick">kCannotPick</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kNoContextMenu">kNoContextMenu</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kInvalidObject">kInvalidObject</a></td><td></td></tr>
<tr class="datainh"><td class="datatype">};</td><td></td><td></td></tr>
<tr class="datainh"><td class="datatype">enum <span class="baseclass">TObject::</span><i>[unnamed]</i> { </td><td class="dataname"><a href="./TObject.html#TObject:kIsOnHeap">kIsOnHeap</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kNotDeleted">kNotDeleted</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kZombie">kZombie</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kBitMask">kBitMask</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kSingleKey">kSingleKey</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kOverwrite">kOverwrite</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kWriteDelete">kWriteDelete</a></td><td></td></tr>
<tr class="datainh"><td class="datatype">};</td><td></td><td></td></tr>

</table></div>
<div class="access" id="dataprot"><b>protected:</b>
<table class="data" id="tabdataprot" cellspacing="0">
<tr class="data"><td class="datatype"><a href="./TH1.html">TH1</a>*</td><td class="dataname"><a name="TSpectrum2:fHistogram"></a>fHistogram</td><td class="datadesc">resulting histogram</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum2:fMaxPeaks"></a>fMaxPeaks</td><td class="datadesc">Maximum number of peaks to be found</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum2:fNPeaks"></a>fNPeaks</td><td class="datadesc">number of peaks found</td></tr>
<tr class="datainh"><td class="datatype"><a href="./TString.html">TString</a></td><td class="dataname"><a href="./TNamed.html#TNamed:fName"><span class="baseclass">TNamed::</span>fName</a></td><td class="datadesc">object identifier</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum2:fPosition"></a>fPosition</td><td class="datadesc">[fNPeaks] array of current peak positions</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum2:fPositionX"></a>fPositionX</td><td class="datadesc">[fNPeaks] X position of peaks</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum2:fPositionY"></a>fPositionY</td><td class="datadesc">[fNPeaks] Y position of peaks</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a></td><td class="dataname"><a name="TSpectrum2:fResolution"></a>fResolution</td><td class="datadesc">resolution of the neighboring peaks</td></tr>
<tr class="datainh"><td class="datatype"><a href="./TString.html">TString</a></td><td class="dataname"><a href="./TNamed.html#TNamed:fTitle"><span class="baseclass">TNamed::</span>fTitle</a></td><td class="datadesc">object title</td></tr>
<tr class="data"><td class="datatype">static <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum2:fgAverageWindow"></a>fgAverageWindow</td><td class="datadesc">Average window of searched peaks</td></tr>
<tr class="data"><td class="datatype">static <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum2:fgIterations"></a>fgIterations</td><td class="datadesc">Maximum number of decon iterations (default=3)</td></tr>

</table></div>
</div>
<h2><a id="TSpectrum2:Class_Charts"></a>Class Charts</h2>
<map name="MapTSpectrum2_Inh" id="MapTSpectrum2_Inh">
<area shape="rect" href="./TNamed.html" title="TNamed" alt="" coords="308,12,411,41"/>
<area shape="rect" href="./TObject.html" title="TObject" alt="" coords="44,12,140,41"/>
</map>
<map name="MapTSpectrum2_InhMem" id="MapTSpectrum2_InhMem">
<area shape="rect" href="./TNamed.html" alt="" coords="344,60,629,109"/>
<area shape="rect" href="./TNamed.html" alt="" coords="541,120,629,297"/>
<area shape="rect" href="./TNamed.html" alt="" coords="443,120,531,297"/>
<area shape="rect" href="./TNamed.html" alt="" coords="344,120,432,297"/>
<area shape="rect" href="./TNamed.html" title="TNamed" alt="" coords="333,16,640,308"/>
<area shape="rect" href="./TObject.html" alt="" coords="224,60,312,183"/>
<area shape="rect" href="./TObject.html" alt="" coords="125,60,213,197"/>
<area shape="rect" href="./TObject.html" alt="" coords="27,60,115,197"/>
<area shape="rect" href="./TObject.html" alt="" coords="256,193,280,228"/>
<area shape="rect" href="./TObject.html" alt="" coords="224,239,312,665"/>
<area shape="rect" href="./TObject.html" alt="" coords="125,224,213,665"/>
<area shape="rect" href="./TObject.html" alt="" coords="27,224,115,665"/>
<area shape="rect" href="./TObject.html" title="TObject" alt="" coords="16,16,323,676"/>
</map>
<map name="MapTSpectrum2_Lib" id="MapTSpectrum2_Lib">
<area shape="rect" href="LibraryDependencies.html" title="All Libraries" alt="" coords="463,121,591,169"/>
</map>
<div class="tabs">
<a id="imgTSpectrum2_Inh" class="tabsel" href="inh/TSpectrum2_Inh.png" onclick="javascript:return SetImg('Charts','inh/TSpectrum2_Inh.png');">Inheritance</a>
<a id="imgTSpectrum2_InhMem" class="tab" href="inhmem/TSpectrum2_InhMem.png" onclick="javascript:return SetImg('Charts','inhmem/TSpectrum2_InhMem.png');">Inherited Members</a>
<a id="imgTSpectrum2_Incl" class="tab" href="incl/TSpectrum2_Incl.png" onclick="javascript:return SetImg('Charts','incl/TSpectrum2_Incl.png');">Includes</a>
<a id="imgTSpectrum2_Lib" class="tab" href="lib/TSpectrum2_Lib.png" onclick="javascript:return SetImg('Charts','lib/TSpectrum2_Lib.png');">Libraries</a><br/>
</div><div class="classcharts"><div class="classchartswidth"></div>
<img id="Charts" alt="Class Charts" class="classcharts" usemap="#MapTSpectrum2_Inh" src="inh/TSpectrum2_Inh.png"/></div>
<h2>Function documentation</h2>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum2:TSpectrum2" href="src/TSpectrum2.cxx.html#nRqSVC">TSpectrum2</a>()</span><br />
<div class="funccomm"><pre> Constructor.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum2:TSpectrum2%1" href="src/TSpectrum2.cxx.html#IXE3iC">TSpectrum2</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> maxpositions, <a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</span><br />
<div class="funccomm"><pre>  maxpositions:  maximum number of peaks
  resolution:    determines resolution of the neighboring peaks
                 default value is 1 correspond to 3 sigma distance
                 between peaks. Higher values allow higher resolution
                 (smaller distance between peaks.
                 May be set later through <a href="./TSpectrum2.html#TSpectrum2:SetResolution" title="void TSpectrum2::SetResolution(Float_t resolution=1)">SetResolution</a>.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum2:_TSpectrum2" href="src/TSpectrum2.cxx.html#uPBNjC">~TSpectrum2</a>()</span><br />
<div class="funccomm"><pre> Destructor.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum2:SetAverageWindow" href="src/TSpectrum2.cxx.html#KDy0X">SetAverageWindow</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> w = 3)</span><br />
<div class="funccomm"><pre> static function: Set average window of searched peaks
 see <a href="./TSpectrum2.html">TSpectrum2</a>::<a href="./TSpectrum2.html#TSpectrum2:SearchHighRes" title="Int_t TSpectrum2::SearchHighRes(float** source,float** dest,Int_t ssizex,Int_t ssizey,Double_t sigma,Double_t threshold,Bool_t backgroundRemove,Int_t deconIterations,Bool_t markov,Int_t averWindow)">SearchHighRes</a>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum2:SetDeconIterations" href="src/TSpectrum2.cxx.html#M9NiQE">SetDeconIterations</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> n = 3)</span><br />
<div class="funccomm"><pre> static function: Set max number of decon iterations in deconvolution operation
 see <a href="./TSpectrum2.html">TSpectrum2</a>::<a href="./TSpectrum2.html#TSpectrum2:SearchHighRes" title="Int_t TSpectrum2::SearchHighRes(float** source,float** dest,Int_t ssizex,Int_t ssizey,Double_t sigma,Double_t threshold,Bool_t backgroundRemove,Int_t deconIterations,Bool_t markov,Int_t averWindow)">SearchHighRes</a>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./TH1.html">TH1</a> * <a class="funcname" name="TSpectrum2:Background" href="src/TSpectrum2.cxx.html#Y9IAGC">Background</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <span class="keyword">int</span> niter = 20, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</span><br />
<div class="funccomm"><pre>
TWO-DIMENSIONAL BACKGROUND ESTIMATION FUNCTION
   This function calculates the background spectrum in the input histogram h.
   The background is returned as a histogram.

   Function parameters:
   -h: input 2-d histogram
   -numberIterations, (default value = 20)
      Increasing numberIterations make the result smoother and lower.
   -option: may contain one of the following options
      - to set the direction parameter
        <span class="string">"BackIncreasingWindow"</span>. By default the direction is BackDecreasingWindow
      - filterOrder-order of clipping filter,  (default <span class="string">"BackOrder2"</span>
                  -possible values= <span class="string">"BackOrder4"</span>
                                    <span class="string">"BackOrder6"</span>
                                    <span class="string">"BackOrder8"</span>
      - <span class="string">"nosmoothing"</span>- if selected, the background is not smoothed
           By default the background is smoothed.
      - smoothWindow-width of smoothing window, (default is <span class="string">"BackSmoothing3"</span>)
                  -possible values= <span class="string">"BackSmoothing5"</span>
                                    <span class="string">"BackSmoothing7"</span>
                                    <span class="string">"BackSmoothing9"</span>
                                    <span class="string">"BackSmoothing11"</span>
                                    <span class="string">"BackSmoothing13"</span>
                                    <span class="string">"BackSmoothing15"</span>
      - <span class="string">"Compton"</span> if selected the estimation of Compton edge
                  will be included.
      - <span class="string">"same"</span> : if this option is specified, the resulting background
                 histogram is superimposed on the picture in the current pad.

  NOTE that the background is only evaluated in the current range of h.
  ie, if h has a bin range (set via h-&gt;GetXaxis()-&gt;SetRange(binmin,binmax),
  the returned histogram will be created with the same number of bins
  as the input histogram h, but only bins from binmin to binmax will be filled
  with the estimated background.


</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum2:Print" href="src/TSpectrum2.cxx.html#m5.OgE">Print</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) const</span><br />
<div class="funccomm"><pre> <a href="./TSpectrum2.html#TSpectrum2:Print" title="void TSpectrum2::Print(Option_t* option=&quot;&quot;)">Print</a> the array of positions
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum2:Search" href="src/TSpectrum2.cxx.html#oBlhtB">Search</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</span><br />
<div class="funccomm"><pre>
TWO-DIMENSIONAL PEAK SEARCH FUNCTION
This function searches for peaks in source spectrum in hin
The number of found peaks and their positions are written into
the members fNpeaks and <a href="./TSpectrum2.html#TSpectrum2:fPositionX" title="Float_t* TSpectrum2::fPositionX">fPositionX</a>.
The search is performed in the current histogram range.

Function parameters:
hin:       pointer to the histogram of source spectrum
sigma:   sigma of searched peaks, for details we refer to manual
threshold: (default=0.05)  peaks with amplitude less than
threshold*highest_peak are discarded.  0&lt;threshold&lt;1

By default, the background is removed before deconvolution.
Specify the option <span class="string">"nobackground"</span> to not remove the background.       //

By default the <span class="string">"Markov"</span> chain algorithm is used.
Specify the option <span class="string">"noMarkov"</span> to disable this algorithm
Note that by default the source spectrum is replaced by a new spectrum//

By default a polymarker object is created and added to the list of
functions of the histogram. The histogram is drawn with the specified
option and the polymarker object drawn on top of the histogram.
The polymarker coordinates correspond to the npeaks peaks found in
the histogram.
A pointer to the polymarker object can be retrieved later via:
<a href="./TList.html">TList</a> *functions = hin-&gt;GetListOfFunctions();
<a href="./TPolyMarker.html">TPolyMarker</a> *pm = (<a href="./TPolyMarker.html">TPolyMarker</a>*)functions-&gt;<a href="./TObject.html#TObject:FindObject" title="TObject* TObject::FindObject(const char* name) or overloads">FindObject</a>(<span class="string">"TPolyMarker"</span>)
Specify the option <span class="string">"goff"</span> to disable the storage and drawing of the
polymarker.


</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum2:SetResolution" href="src/TSpectrum2.cxx.html#pJZznE">SetResolution</a>(<a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</span><br />
<div class="funccomm"><pre>  resolution: determines resolution of the neighboring peaks
              default value is 1 correspond to 3 sigma distance
              between peaks. Higher values allow higher resolution
              (smaller distance between peaks.
              May be set later through <a href="./TSpectrum2.html#TSpectrum2:SetResolution" title="void TSpectrum2::SetResolution(Float_t resolution=1)">SetResolution</a>.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span> * <a class="funcname" name="TSpectrum2:Background%1" href="src/TSpectrum2.cxx.html#v4s7sD">Background</a>(<span class="keyword">float</span>** spectrum, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsX, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsY, <a href="./ListOfTypes.html#Int_t">Int_t</a> direction, <a href="./ListOfTypes.html#Int_t">Int_t</a> filterType)</span><br />
<div class="funccomm"><pre>
TWO-DIMENSIONAL BACKGROUND ESTIMATION FUNCTION - RECTANGULAR RIDGES
This function calculates background spectrum from source spectrum.
The result is placed to the array pointed by spectrum pointer.

Function parameters:
spectrum-pointer to the array of source spectrum
ssizex-x length of spectrum
ssizey-y length of spectrum
numberIterationsX-maximal x width of clipping window
numberIterationsY-maximal y width of clipping window
for details we refer to manual
direction- direction of change of clipping window
- possible values=<a href="./TSpectrum2.html#TSpectrum2:kBackIncreasingWindow" title="const enum TSpectrum2:: TSpectrum2::kBackIncreasingWindow">kBackIncreasingWindow</a>
<a href="./TSpectrum2.html#TSpectrum2:kBackDecreasingWindow" title="const enum TSpectrum2:: TSpectrum2::kBackDecreasingWindow">kBackDecreasingWindow</a>
filterType-determines the algorithm of the filtering
-possible values=<a href="./TSpectrum2.html#TSpectrum2:kBackSuccessiveFiltering" title="const enum TSpectrum2:: TSpectrum2::kBackSuccessiveFiltering">kBackSuccessiveFiltering</a>
<a href="./TSpectrum2.html#TSpectrum2:kBackOneStepFiltering" title="const enum TSpectrum2:: TSpectrum2::kBackOneStepFiltering">kBackOneStepFiltering</a>





</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:20.0pt'>Background
estimation</span></b></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>Goal:
Separation of useful information (peaks) from useless information (background)</span></i><span
style='font-size:18.0pt'> </span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>method is based on Sensitive
Nonlinear Iterative Peak (SNIP) clipping algorithm [1]</span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>there exist two algorithms for the
estimation of new value in the channel <sub><img width=28 height=24
src="gif/TSpectrum2_Background1.gif"></sub></span></p>
<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'><span
style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:16.0pt'>Algorithm
based on Successive Comparisons</span></i></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>It
is an extension of one-dimensional SNIP algorithm to another dimension. For
details we refer to [2].</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:16.0pt'>Algorithm
based on One Step Filtering</span></i></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>New
value in the estimated channel is calculated as</span></p>
<p class=MsoNormal style='text-align:justify'><sub><img width=133 height=39
src="gif/TSpectrum2_Background2.gif"></sub></p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><sub><img width=600 height=128
src="gif/TSpectrum2_Background3.gif"></sub></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><sub><img width=190 height=38
src="gif/TSpectrum2_Background4.gif"></sub>.</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>where
p = 1, 2, , number_of_iterations. </span></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Function:</span></i></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt'>const
<a href="http://root.cern.ch/root/html/ListOfTypes.html#char" target="_parent">char</a>*
</span></b><span style='font-size:18.0pt'><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum2::Background</b></a><b>
(<a href="http://root.cern.ch/root/html/ListOfTypes.html#float" target="_parent">float</a>
**spectrum, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> ssizex, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
ssizey, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> numberIterationsX, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
numberIterationsY, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> direction, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
filterType)  </b></span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>This
function calculates background spectrum from the source spectrum.  The result
is placed in the matrix pointed by spectrum pointer.  One can also switch the
direction of the change of the clipping window and to select one of the two
above given algorithms.</span><span style='font-size:18.0pt'> </span><span
style='font-size:16.0pt'>On successful completion it returns 0. On error it
returns pointer to the string describing error.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='font-size:16.0pt;color:red'>Parameters:</span></i></p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>spectrum</span></b>-pointer
to the matrix of source spectrum                  </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>ssizex, ssizey</span></b>-lengths
of the spectrum matrix                                 </p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>numberIterationsX, numberIterationsY</span></b>maximal
widths of clipping</p>
<p class=MsoNormal style='text-align:justify'>        window,                                
</p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>direction</span></b>-
direction of change of clipping window                  </p>
<p class=MsoNormal>               - possible
values=kBackIncreasingWindow                      </p>
<p class=MsoNormal>                                           
kBackDecreasingWindow                      </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>filterType</span></b>-type
of the clipping algorithm,                              </p>
<p class=MsoNormal>                  -possible values=kBack SuccessiveFiltering</p>
<p class=MsoNormal>                                             
kBackOneStepFiltering                              </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i><span style='font-size:18.0pt'>References:</span></i></b></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[1] 
C. G Ryan et al.: SNIP, a statistics-sensitive background treatment for the
quantitative analysis of PIXE spectra in geoscience applications. NIM, B34
(1988), 396-402.</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[2]
</span><span lang=SK style='font-size:16.0pt'> M. Morhá&#269;, J. Kliman, V.
Matouek, M. Veselský, I. Turzo</span><span style='font-size:16.0pt'>.:
Background elimination methods for multidimensional gamma-ray spectra. NIM,
A401 (1997) 113-132.</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>

</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Example 1 script Back_gamma64.c
:</span></i></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Background1.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
1 Original two-dimensional gamma-gamma-ray spectrum</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
width=602 height=418 src="gif/TSpectrum2_Background2.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
2 Background estimated from data from Fig. 1 using decreasing clipping window with
widths 4, 4 and algorithm based on successive comparisons. The estimate
includes not only continuously changing background but also one-dimensional
ridges.</span></b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt;color:green'><img
width=602 height=418 src="gif/TSpectrum2_Background3.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
3 Resulting peaks after subtraction of the estimated background (Fig. 2) from original
two-dimensional gamma-gamma-ray spectrum (Fig. 1).</span></b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt;color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt;color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:green'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the background estimator (class
TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Back_gamma64.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Back_gamma64() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>      source[i]=new float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   back=(TH2F*) f-&gt;Get(&quot;back1;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Background = new
TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing
window&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = back-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }     </p>
<p class=MsoNormal> s-&gt;Background(source,nbinsx,nbinsy,4,4,kBackDecreasingWindow,kBackSuccessiveFiltering);</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);   </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   back-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Example 2 script Back_gamma256.c
:</span></i></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Background4.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
4 Original two-dimensional gamma-gamma-ray spectrum 256x256 channels</span></b></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Background5.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
5 Peaks after subtraction of the estimated background (increasing clipping
window with widths 8, 8 and algorithm based on successive comparisons) from original
two-dimensional gamma-gamma-ray spectrum (Fig. 4).</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:green'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the background estimator (class
TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Back_gamma256.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Back_gamma256() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>      source[i]=new float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   back=(TH2F*) f-&gt;Get(&quot;back2;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Background = new
TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing
window&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = back-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }     </p>
<p class=MsoNormal> s-&gt;Background(source,nbinsx,nbinsy,8,8,kBackIncreasingWindow,kBackSuccessiveFiltering);</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);   </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   back-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Example 3 script Back_synt256.c
:</span></i></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Background6.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
6 Original two-dimensional synthetic spectrum 256x256 channels</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
width=602 height=418 src="gif/TSpectrum2_Background7.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
7 Peaks after subtraction of the estimated background (increasing clipping
window with widths 8, 8 and algorithm based on successive comparisons) from original
two-dimensional gamma-gamma-ray spectrum (Fig. 6). One can observe artifacts
(ridges) around the peaks due to the employed algorithm.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
width=602 height=418 src="gif/TSpectrum2_Background8.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
8 Peaks after subtraction of the estimated background (increasing clipping
window with widths 8, 8 and algorithm based on one step filtering) from original
two-dimensional gamma-gamma-ray spectrum (Fig. 6).  The artifacts from the
above given Fig. 7 disappeared.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:green'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the background estimator (class
TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Back_synt256.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Back_synt256() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>      source[i]=new float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *back = new TH2F(&quot;back&quot;,&quot;Background estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   back=(TH2F*) f-&gt;Get(&quot;back3;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Background = new
TCanvas(&quot;Background&quot;,&quot;Estimation of background with increasing
window&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = back-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }     </p>
<p class=MsoNormal> s-&gt;Background(source,nbinsx,nbinsy,8,8,kBackIncreasingWindow,kBackSuccessiveFiltering);//kBackOneStepFiltering</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       back-&gt;SetBinContent(i + 1,j + 1, source[i][j]);   </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   back-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span>* <a class="funcname" name="TSpectrum2:SmoothMarkov" href="src/TSpectrum2.cxx.html#xk5CKC">SmoothMarkov</a>(<span class="keyword">float</span>** source, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</span><br />
<div class="funccomm"><pre>
   TWO-DIMENSIONAL MARKOV SPECTRUM SMOOTHING FUNCTION

   This function calculates smoothed spectrum from source spectrum
      based on Markov chain method.
   The result is placed in the array pointed by source pointer.

   Function parameters:
   source-pointer to the array of source spectrum
   ssizex-x length of source
   ssizey-y length of source
   averWindow-width of averaging smoothing window



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:20.0pt'>Smoothing</span></b></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Goal: Suppression of
statistical fluctuations</span></i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>the algorithm is based on discrete
Markov chain, which has very simple invariant distribution</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>            <sub><img width=551 height=63
src="gif/TSpectrum2_Smoothing1.gif"></sub><span style='font-size:16.0pt;
font-family:Arial'>     </span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
font-family:Arial'>        </span><sub><img width=28 height=36
src="gif/TSpectrum2_Smoothing2.gif"></sub><span style='font-size:16.0pt;
font-family:Arial'>  being defined from the normalization condition </span><sub><img
width=70 height=52 src="gif/TSpectrum2_Smoothing3.gif"></sub></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><span style='font-size:16.0pt;font-family:Arial'>         n
is the length of the smoothed spectrum and </span></p>
<p class=MsoNormal>
<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=57 height=15></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=258 height=60 src="gif/TSpectrum2_Smoothing4.gif"></td>
 </tr>
</table>
<span style='font-size:16.0pt;font-family:Arial'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:18.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<br clear=ALL>
<p class=MsoNormal style='margin-left:34.2pt;text-align:justify'><span
style='font-size:16.0pt;font-family:Arial'>is the probability of the change of
the peak position from channel i to the channel i+1. </span> <sub><img
width=28 height=36 src="gif/TSpectrum2_Smoothing5.gif"></sub><span
style='font-size:16.0pt;font-family:Arial'>is the normalization constant so
that </span><span style='font-family:Arial'><sub><img width=133 height=34
src="gif/TSpectrum2_Smoothing6.gif"></sub> </span><span style='font-size:16.0pt;
font-family:Arial'>and m is a width of smoothing window. We have extended this
algortihm to two dimensions. </span></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Function:</span></i></p>
<p class=MsoNormal><b><span style='font-size:18.0pt'>const <a
href="http://root.cern.ch/root/html/ListOfTypes.html#char" target="_parent">char</a>*
</span></b><span style='font-size:18.0pt'><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum2::SmoothMarkov</b></a><b>(<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float" target="_parent">float</a>
**fSpectrum, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> ssizex, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
ssizey,  <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> averWindow)  </b></span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>This
function calculates smoothed spectrum from the source spectrum based on Markov
chain method. The result is placed in the vector pointed by source pointer. On
successful completion it returns 0. On error it returns pointer to the string
describing error.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='font-size:16.0pt;color:red'>Parameters:</span></i></p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>fSpectrum</span></b>-pointer
to the matrix of source spectrum                  </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>ssizex, ssizey</span></b>
-lengths of the spectrum matrix                                 </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>averWindow</span></b>-width
of averaging smoothing window </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i><span style='font-size:18.0pt'>Reference:</span></i></b></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[1]
Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376
(1996), 451<b>.</b>  </span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>

</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 4  script Smooth.c
:</span></i></p>
<p class=MsoNormal><span style='font-size:16.0pt'><img width=300 height=209
src="gif/TSpectrum2_Smoothing1.jpg"><img width=297 height=207
src="gif/TSpectrum2_Smoothing2.jpg"></span></p>
<p class=MsoNormal><b><span style='font-size:16.0pt'>Fig. 9 Original noisy
spectrum.</span></b><b><span style='font-size:14.0pt'>    </span></b><b><span
style='font-size:16.0pt'>Fig. 10 Smoothed spectrum m=3</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt'>Peaks can hardly be
observed.     Peaks become apparent.</span></b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt'><img width=293 height=203
src="gif/TSpectrum2_Smoothing3.jpg"><img width=297 height=205
src="gif/TSpectrum2_Smoothing4.jpg"></span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt'>Fig. 11 Smoothed spectrum
m=5 Fig.12 Smoothed spectrum m=7</span></b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the Markov smoothing (class
TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Smooth.C</p>
<p class=MsoNormal>#include &lt;TSpectrum&gt; </p>
<p class=MsoNormal>void Smooth() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 256;</p>
<p class=MsoNormal>   Double_t nbinsy = 256;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *smooth = new
TH2F(&quot;smooth&quot;,&quot;Background
estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   smooth=(TH2F*) f-&gt;Get(&quot;smooth1;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Smoothing = new
TCanvas(&quot;Smoothing&quot;,&quot;Markov smoothing&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = smooth-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   s-&gt;SmoothMarkov(source,nbinsx,nbinsx,3);//5,7</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       smooth-&gt;SetBinContent(i + 1,j + 1,
source[i][j]);   </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   smooth-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span> * <a class="funcname" name="TSpectrum2:Deconvolution" href="src/TSpectrum2.cxx.html#eaA27C">Deconvolution</a>(<span class="keyword">float</span>** source, <span class="keyword">float</span>** resp, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterations, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberRepetitions, <a href="./ListOfTypes.html#Double_t">Double_t</a> boost)</span><br />
<div class="funccomm"><pre>
   TWO-DIMENSIONAL DECONVOLUTION FUNCTION
   This function calculates deconvolution from source spectrum
   according to response spectrum
   The result is placed in the matrix pointed by source pointer.

   Function parameters:
   source-pointer to the matrix of source spectrum
   resp-pointer to the matrix of response spectrum
   ssizex-x length of source and response spectra
   ssizey-y length of source and response spectra
   numberIterations, for details we refer to manual
   numberRepetitions, for details we refer to manual
   boost, boosting factor, for details we refer to manual



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:20.0pt'>Deconvolution</span></b></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>Goal:
Improvement of the resolution in spectra, decomposition of multiplets</span></i></p>
<p class=MsoNormal><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:16.0pt'>Mathematical formulation of
the 2-dimensional convolution system is</span></p>
<p class=MsoNormal style='margin-left:18.0pt'>
<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=0 height=18></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=577 height=138 src="gif/TSpectrum2_Deconvolution1.gif"></td>
 </tr>
</table>
<span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<br clear=ALL>
<p class=MsoNormal><span style='font-size:16.0pt'>where h(i,j) is the impulse
response function, x, y are input and output matrices, respectively, <sub><img
width=45 height=24 src="gif/TSpectrum2_Deconvolution2.gif"></sub> are the lengths
of x and h matrices</span><i><span style='font-size:18.0pt'> </span></i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>let us assume that we know the
response and the output matrices (spectra) of the above given system. </span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>the deconvolution represents
solution of the overdetermined system of linear equations, i.e.,  the
calculation of the matrix <b>x.</b></span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>from numerical stability point of
view the operation of deconvolution is extremely critical (ill-posed  problem)
as well as time consuming operation. </span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>the Gold deconvolution algorithm
proves to work very well even for 2-dimensional systems. Generalization of the
algorithm for 2-dimensional systems was presented in [1], [2].</span></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>for Gold deconvolution algorithm
as well as for boosted deconvolution algorithm we refer also to TSpectrum </span></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Function:</span></i></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt'>const
<a href="http://root.cern.ch/root/html/ListOfTypes.html#char">char</a>* </span></b><a
name="TSpectrum:Deconvolution1"></a><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b><span
style='font-size:18.0pt'>TSpectrum2::Deconvolution</span></b></a><b><span
style='font-size:18.0pt'>(<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a> **source,
const <a href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a>
**resp, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> ssizex,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> ssizey, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> numberIterations,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> numberRepetitions,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#double">double</a></span></b><b><span
style='font-size:16.0pt'> </span></b><b><span style='font-size:18.0pt'>boost)</span></b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>This
function calculates deconvolution from source spectrum according to response
spectrum using Gold deconvolution algorithm. The result is placed in the matrix
pointed by source pointer. On successful completion it returns 0. On error it
returns pointer to the string describing error. If desired after every
numberIterations one can apply boosting operation (exponential function with
exponent given by boost coefficient) and repeat it numberRepetitions times.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='font-size:16.0pt;color:red'>Parameters:</span></i></p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>source</span></b>-pointer
to the matrix of source spectrum                  </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>resp</span></b>-pointer
to the matrix of response spectrum                  </p>
<p class=MsoNormal>        <b><span style='font-size:14.0pt'>ssizex, ssizey</span></b>-lengths
of the spectrum matrix                                 </p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>numberIterations</span></b>-number of iterations </p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>numberRepetitions</span></b>-number of repetitions
for boosted deconvolution. It must be </p>
<p class=MsoNormal style='text-align:justify'>        greater or equal to one.</p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>boost</span></b>-boosting coefficient, applies only
if numberRepetitions is greater than one.  </p>
<p class=MsoNormal style='text-align:justify'>        <span style='font-size:
14.0pt;color:fuchsia'>Recommended range &lt;1,2&gt;.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i><span style='font-size:18.0pt'>References:</span></i></b></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'> [1]
</span><span lang=SK style='font-size:16.0pt'>M. Morhá&#269;, J. Kliman, V.
Matouek, M. Veselský, I. Turzo</span><span style='font-size:16.0pt'>.:
Efficient one- and two-dimensional Gold deconvolution and its application to
gamma-ray spectra decomposition. NIM, A401 (1997) 385-408.</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[2]
Morhá&#269; M., Matouek V., Kliman J., Efficient algorithm of multidimensional
deconvolution and its application to nuclear data processing, Digital Signal
Processing 13 (2003) 144. </span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>

</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 5  script Decon.c
:</span></i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font-size:16.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:16.0pt'>response function (usually peak)
should be shifted to the beginning of the coordinate system (see Fig. 13)</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution1.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
13 2-dimensional response spectrum</span></b></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution2.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
14 2-dimensional gamma-gamma-ray input spectrum (before deconvolution)</span></b></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution3.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
15 Spectrum from Fig. 14 after deconvolution (1000 iterations)</span></b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the Gold deconvolution (class
TSpectrum2).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Decon.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Decon() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 256;</p>
<p class=MsoNormal>   Double_t nbinsy = 256;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Gold
deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   decon=(TH2F*) f-&gt;Get(&quot;decon1;1&quot;);</p>
<p class=MsoNormal>   Float_t ** response = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    response[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response
matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   resp=(TH2F*) f-&gt;Get(&quot;resp1;1&quot;);   </p>
<p class=MsoNormal>   TCanvas *Deconvol = new
TCanvas(&quot;Deconvolution&quot;,&quot;Gold deconvolution&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = decon-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                response[i][j] = resp-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);  
</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       decon-&gt;SetBinContent(i + 1,j + 1, source[i][j]);  
</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   </p>
<p class=MsoNormal>   decon-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 6  script
Decon2.c :</span></i></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution4.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
16 Response spectrum</span></b></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution5.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
17 Original synthetic input spectrum (before deconvolution). It is composed of
17 peaks. 5 peaks are overlapping in the outlined multiplet and two peaks in
doublet.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
width=602 height=418 src="gif/TSpectrum2_Deconvolution6.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
18 Spectrum from Fig. 17 after deconvolution (1000 iterations). Resolution is
improved but the peaks in multiplet remained unresolved.</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate the Gold deconvolution (class
TSpectrum2).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Decon2.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Decon2() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Gold
deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   decon=(TH2F*) f-&gt;Get(&quot;decon2;1&quot;);</p>
<p class=MsoNormal>   Float_t ** response = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    response[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response
matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   resp=(TH2F*) f-&gt;Get(&quot;resp2;1&quot;);   </p>
<p class=MsoNormal>   TCanvas *Deconvol = new
TCanvas(&quot;Deconvolution&quot;,&quot;Gold
deconvolution&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = decon-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                response[i][j] = resp-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);  
</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       decon-&gt;SetBinContent(i + 1,j + 1, source[i][j]);  
</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   decon-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 7  script
Decon2HR.c :</span></i></p>
<p class=MsoNormal><img width=602 height=418
src="gif/TSpectrum2_Deconvolution7.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
19 Spectrum from Fig. 17 after boosted deconvolution (50 iterations repeated 20
times, boosting coefficient was 1.2). All the peaks in multiplet as well as in
doublet are completely decomposed.</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate boosted Gold deconvolution (class
TSpectrum2).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Decon2HR.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>//#include &lt;TSpectrum2&gt; </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Decon2HR() {</p>
<p class=MsoNormal>   Int_t i, j;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *decon = new TH2F(&quot;decon&quot;,&quot;Boosted
Gold deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   decon=(TH2F*) f-&gt;Get(&quot;decon2;1&quot;);</p>
<p class=MsoNormal>   Float_t ** response = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    response[i]=new
float[nbinsy];     </p>
<p class=MsoNormal>   TH2F *resp = new TH2F(&quot;resp&quot;,&quot;Response
matrix&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   resp=(TH2F*) f-&gt;Get(&quot;resp2;1&quot;);   </p>
<p class=MsoNormal>   TCanvas *Deconvol = new
TCanvas(&quot;Deconvolution&quot;,&quot;Gold
deconvolution&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum *s = new TSpectrum();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = decon-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                response[i][j] = resp-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   s-&gt;Deconvolution(source,response,nbinsx,nbinsy,1000,1,1);  
</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++)</p>
<p class=MsoNormal>       decon-&gt;SetBinContent(i + 1,j + 1, source[i][j]);  
</p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal>   decon-&gt;Draw(&quot;SURF&quot;);  </p>
<p class=MsoNormal>   }</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum2:SearchHighRes" href="src/TSpectrum2.cxx.html#TpXyPD">SearchHighRes</a>(<span class="keyword">float</span>** source, <span class="keyword">float</span>** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> backgroundRemove, <a href="./ListOfTypes.html#Int_t">Int_t</a> deconIterations, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</span><br />
<div class="funccomm"><pre>
TWO-DIMENSIONAL HIGH-RESOLUTION PEAK SEARCH FUNCTION
This function searches for peaks in source spectrum
It is based on deconvolution method. First the background is
removed (if desired), then Markov spectrum is calculated
(if desired), then the response function is generated
according to given sigma and deconvolution is carried out.

Function parameters:
source-pointer to the matrix of source spectrum
dest-pointer to the matrix of resulting deconvolved spectrum
ssizex-x length of source spectrum
ssizey-y length of source spectrum
sigma-sigma of searched peaks, for details we refer to manual
threshold-threshold value in % for selected peaks, peaks with
amplitude less than threshold*highest_peak/100
are ignored, see manual
backgroundRemove-logical variable, set if the removal of
background before deconvolution is desired
deconIterations-number of iterations in deconvolution operation
markov-logical variable, if it is <a href="./ListOfTypes.html#bool">true</a>, first the source spectrum
is replaced by new spectrum calculated using Markov
chains method.
averWindow-averanging window of searched peaks, for details
we refer to manual (applies only for Markov method)



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal><b><span style='font-size:20.0pt'>Peaks searching</span></b></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>&nbsp;</span></i></p>
<p class=MsoNormal style='text-align:justify'><i><span style='font-size:18.0pt'>Goal:
to identify automatically the peaks in spectrum with the presence of the
continuous background, one-fold coincidences (ridges) and statistical
fluctuations - noise.</span></i><span style='font-size:18.0pt'> </span></p>
<p class=MsoNormal><span style='font-size:16.0pt;font-family:Arial'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
font-family:Arial'>The common problems connected with correct peak
identification in two-dimensional coincidence spectra are</span></p>
<ul style='margin-top:0mm' type=disc>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>non-sensitivity to noise, i.e., only statistically
     relevant peaks should be identified</span></li>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>non-sensitivity of the algorithm to continuous
     background</span></li>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>non-sensitivity to one-fold coincidences (coincidences
     peak  background in both dimensions) and their crossings</span></li>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>ability to identify peaks close to the edges of the
     spectrum region. Usually peak finders fail to detect them</span></li>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>resolution, decomposition of doublets and multiplets.
     The algorithm should be able to recognize close positioned peaks.</span><span
     style='font-size:18.0pt'> </span></li>
 <li class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt;
     font-family:Arial'>ability to identify peaks with different sigma</span></li>
</ul>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'>Function:</span></i></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:18.0pt'><a
href="http://root.cern.ch/root/html/ListOfTypes.html#Int_t">Int_t</a> </span></b><a
name="TSpectrum:Search1HighRes"></a><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b><span
style='font-size:18.0pt'>TSpectrum2::SearchHighRes</span></b></a><b><span
style='font-size:18.0pt'> (<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a> **source,<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a> **dest, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> ssizex, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> ssizey, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a> sigma, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#double">double</a> threshold,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#bool">bool</a> backgroundRemove,<a
href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> deconIterations,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#bool">bool</a> markov,
<a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a> averWindow)
  </span></b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>This
function searches for peaks in source spectrum. It is based on deconvolution
method. First the background is removed (if desired), then Markov smoothed
spectrum is calculated (if desired), then the response function is generated
according to given sigma and deconvolution is carried out. The order of peaks
is arranged according to their heights in the spectrum after background
elimination. The highest peak is the first in the list. On success it returns
number of found peaks.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='font-size:16.0pt;color:red'>Parameters:</span></i></p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>source</span></b>-pointer to the matrix of source
spectrum                  </p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>dest</span></b>-resulting spectrum after deconvolution</p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>ssizex, ssizey</span></b>-lengths of the source and
destination spectra                </p>
<p class=MsoNormal style='text-align:justify'>        <b><span
style='font-size:14.0pt'>sigma</span></b>-sigma of searched peaks</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b><span
style='font-size:14.0pt'>threshold</span></b>-<span style='font-size:16.0pt'> </span>threshold
value in % for selected peaks, peaks with amplitude less than
threshold*highest_peak/100 are ignored</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b><span
style='font-size:14.0pt'>backgroundRemove</span></b>-<span style='font-size:
16.0pt'> </span>background_remove-logical variable, true if the removal of
background before deconvolution is desired  </p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b><span
style='font-size:14.0pt'>deconIterations</span></b>-number of iterations in
deconvolution operation</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b><span
style='font-size:14.0pt'>markov</span></b>-logical variable, if it is true,
first the source spectrum is replaced by new spectrum calculated using Markov
chains method </p>
<p class=MsoNormal style='margin-left:19.95pt;text-align:justify;text-indent:
2.85pt'><b><span style='font-size:14.0pt'>averWindow</span></b>-width of
averaging smoothing window </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i><span style='font-size:18.0pt'>References:</span></i></b></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[1]
M.A. Mariscotti: A method for identification of peaks in the presence of
background and its application to spectrum analysis. NIM 50 (1967), 309-320.</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[2]
</span><span lang=SK style='font-size:16.0pt'> M. Morhá&#269;, J. Kliman, V.
Matouek, M. Veselský, I. Turzo</span><span style='font-size:16.0pt'>.:Identification
of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000)
108-125.</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>[3]
Z.K. Silagadze, A new algorithm for automatic photopeak searches. NIM A 376
(1996), 451.</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>

</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal><b><span style='font-size:18.0pt'>Examples of peak searching
method</span></b></p>
<p class=MsoNormal><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'><a
href="http://root.cern.ch/root/html/src/TSpectrum.cxx.html#TSpectrum:Search1HighRes"
target="_parent">SearchHighRes</a> function provides users with the possibility
to vary the input parameters and with the access to the output deconvolved data
in the destination spectrum. Based on the output data one can tune the
parameters. </span></p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 8  script Src.c:</span></i></p>
<p class=MsoNormal><span style='font-size:16.0pt'><img border=0 width=602
height=455 src="gif/TSpectrum2_Searching1.jpg"></span></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
20 Two-dimensional spectrum with found peaks denoted by markers (<sub><img
border=0 width=40 height=19 src="gif/TSpectrum2_Searching2.gif"></sub>,
threshold=5%, 3 iterations steps in the deconvolution)</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching3.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
21 Spectrum from Fig. 20 after background elimination and deconvolution</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate high resolution peak searching
function (class TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Src.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Src() {</p>
<p class=MsoNormal>   Int_t i, j, nfound;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   Float_t ** dest = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    dest[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   TH2F *search = new TH2F(&quot;search&quot;,&quot;High
resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   search=(TH2F*) f-&gt;Get(&quot;search4;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Searching = new
TCanvas(&quot;Searching&quot;,&quot;High resolution peak
searching&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum2 *s = new TSpectrum2();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = search-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   nfound = s-&gt;SearchHighRes(source, dest, nbinsx,
nbinsy, 2, 5, kTRUE, 3, kFALSE, 3);   </p>
<p class=MsoNormal>   printf(&quot;Found %d candidate peaks\n&quot;,nfound);</p>
<p class=MsoNormal>   for(i=0;i&lt;nfound;i++)</p>
<p class=MsoNormal>             printf(&quot;posx= %d, posy= %d, value=
%d\n&quot;,(int)(fPositionX[i]+0.5), (int)(fPositionY[i]+0.5),
(int)source[(int)(fPositionX[i]+0.5)][(int)(fPositionY[i]+0.5)]);        </p>
<p class=MsoNormal>}</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 9  script Src2.c:</span></i></p>
<p class=MsoNormal><img border=0 width=602 height=455
src="gif/TSpectrum2_Searching4.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
22 Two-dimensional noisy spectrum with found peaks denoted by markers (<sub><img
border=0 width=40 height=19 src="gif/TSpectrum2_Searching2.gif"></sub>,
threshold=10%, 10 iterations steps in the deconvolution). One can observe that
the algorithm is insensitive to the crossings of one-dimensional ridges. It
identifies only two-cooincidence peaks.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching5.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
23 Spectrum from Fig. 22 after background elimination and deconvolution</span></b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate high resolution peak searching
function (class TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Src2.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Src2() {</p>
<p class=MsoNormal>   Int_t i, j, nfound;</p>
<p class=MsoNormal>   Double_t nbinsx = 256;</p>
<p class=MsoNormal>   Double_t nbinsy = 256;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   Float_t ** dest = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    dest[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   TH2F *search = new TH2F(&quot;search&quot;,&quot;High
resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   search=(TH2F*) f-&gt;Get(&quot;back3;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Searching = new
TCanvas(&quot;Searching&quot;,&quot;High resolution peak
searching&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum2 *s = new TSpectrum2();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = search-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   nfound = s-&gt;SearchHighRes(source, dest, nbinsx,
nbinsy, 2, 10, kTRUE, 10, kFALSE, 3);   </p>
<p class=MsoNormal>   printf(&quot;Found %d candidate peaks\n&quot;,nfound);</p>
<p class=MsoNormal>   for(i=0;i&lt;nfound;i++)</p>
<p class=MsoNormal>             printf(&quot;posx= %d, posy= %d, value=
%d\n&quot;,(int)(fPositionX[i]+0.5), (int)(fPositionY[i]+0.5),
(int)source[(int)(fPositionX[i]+0.5)][(int)(fPositionY[i]+0.5)]);        </p>
<p class=MsoNormal>}</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 10  script Src3.c:</span></i></p>
<p class=MsoNormal><img border=0 width=602 height=455
src="gif/TSpectrum2_Searching6.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
24 Two-dimensional spectrum with 15 found peaks denoted by markers. Some peaks
are positioned close to each other. It is necessary to increase number of
iterations in the deconvolution. In next 3 Figs. we shall study the influence
of this parameter.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching7.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
25 Spectrum from Fig. 24 after deconvolution (# of iterations = 3). Number of
identified peaks = 13.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching8.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
26 Spectrum from Fig. 24 after deconvolution (# of iterations = 10). Number of
identified peaks = 13.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching9.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
27 Spectrum from Fig. 24 after deconvolution (# of iterations = 100). Number of
identified peaks = 15. Now the algorithm is able to decompose two doublets in
the spectrum.</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate high resolution peak searching
function (class TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Src3.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Src3() {</p>
<p class=MsoNormal>   Int_t i, j, nfound;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   Float_t ** dest = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    dest[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   TH2F *search = new TH2F(&quot;search&quot;,&quot;High
resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   search=(TH2F*) f-&gt;Get(&quot;search1;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Searching = new
TCanvas(&quot;Searching&quot;,&quot;High resolution peak
searching&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum2 *s = new TSpectrum2();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = search-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   nfound = s-&gt;SearchHighRes(source, dest, nbinsx,
nbinsy, 2, 2, kFALSE, 3, kFALSE, 1);//3, 10, 100   </p>
<p class=MsoNormal>   printf(&quot;Found %d candidate peaks\n&quot;,nfound);</p>
<p class=MsoNormal> </p>
<p class=MsoNormal>   for(i=0;i&lt;nfound;i++)</p>
<p class=MsoNormal>             printf(&quot;posx= %d, posy= %d, value=
%d\n&quot;,(int)(fPositionX[i]+0.5), (int)(fPositionY[i]+0.5),
(int)source[(int)(fPositionX[i]+0.5)][(int)(fPositionY[i]+0.5)]);        </p>
<p class=MsoNormal>}</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 11  script Src4.c:</span></i></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching10.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
28 Two-dimensional spectrum with peaks with different sigma denoted by markers (<sub><img
border=0 width=39 height=19 src="gif/TSpectrum2_Searching11.gif"></sub>,
threshold=5%, 10 iterations steps in the deconvolution, Markov smoothing with
window=3)</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching12.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
29 Spectrum from Fig. 28 after smoothing and deconvolution.</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate high resolution peak searching
function (class TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Src4.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Src4() {</p>
<p class=MsoNormal>   Int_t i, j, nfound;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   Float_t ** dest = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    dest[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   TH2F *search = new TH2F(&quot;search&quot;,&quot;High
resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   search=(TH2F*) f-&gt;Get(&quot;search2;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Searching = new
TCanvas(&quot;Searching&quot;,&quot;High resolution peak
searching&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum2 *s = new TSpectrum2();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = search-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   nfound = s-&gt;SearchHighRes(source, dest, nbinsx,
nbinsy, 3, 5, kFALSE, 10, kTRUE, 3);   </p>
<p class=MsoNormal>   printf(&quot;Found %d candidate peaks\n&quot;,nfound);</p>
<p class=MsoNormal>   for(i=0;i&lt;nfound;i++)</p>
<p class=MsoNormal>             printf(&quot;posx= %d, posy= %d, value=
%d\n&quot;,(int)(fPositionX[i]+0.5), (int)(fPositionY[i]+0.5),
(int)source[(int)(fPositionX[i]+0.5)][(int)(fPositionY[i]+0.5)]);        </p>
<p class=MsoNormal>}</p>
<p class=MsoNormal><i><span style='font-size:16.0pt'>Example 12  script Src5.c:</span></i></p>
<p class=MsoNormal><img border=0 width=602 height=455
src="gif/TSpectrum2_Searching13.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
30 Two-dimensional spectrum with peaks positioned close to the edges denoted by
markers (<sub><img border=0 width=40 height=19
src="gif/TSpectrum2_Searching2.gif"></sub>, threshold=5%, 10 iterations
steps in the deconvolution)</span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=602 height=455 src="gif/TSpectrum2_Searching14.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'>Fig.
31 Spectrum from Fig. 30 after deconvolution.</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:16.0pt;color:#339966'>Script:</span></b></p>
<p class=MsoNormal>// Example to illustrate high resolution peak searching
function (class TSpectrum).</p>
<p class=MsoNormal>// To execute this example, do</p>
<p class=MsoNormal>// root &gt; .x Src5.C</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>#include &lt;TSpectrum2&gt;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>void Src5() {</p>
<p class=MsoNormal>   Int_t i, j, nfound;</p>
<p class=MsoNormal>   Double_t nbinsx = 64;</p>
<p class=MsoNormal>   Double_t nbinsy = 64;   </p>
<p class=MsoNormal>   Double_t xmin  = 0;</p>
<p class=MsoNormal>   Double_t xmax  = (Double_t)nbinsx;</p>
<p class=MsoNormal>   Double_t ymin  = 0;</p>
<p class=MsoNormal>   Double_t ymax  = (Double_t)nbinsy;   </p>
<p class=MsoNormal>   Float_t ** source = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    source[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   Float_t ** dest = new float *[nbinsx];   </p>
<p class=MsoNormal>   for (i=0;i&lt;nbinsx;i++)</p>
<p class=MsoNormal>                                    dest[i]=new
float[nbinsy];</p>
<p class=MsoNormal>   TH2F *search = new TH2F(&quot;search&quot;,&quot;High
resolution peak searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax);</p>
<p class=MsoNormal>   TFile *f = new
TFile(&quot;spectra2\\TSpectrum2.root&quot;);</p>
<p class=MsoNormal>   search=(TH2F*) f-&gt;Get(&quot;search3;1&quot;);</p>
<p class=MsoNormal>   TCanvas *Searching = new
TCanvas(&quot;Searching&quot;,&quot;High resolution peak
searching&quot;,10,10,1000,700);</p>
<p class=MsoNormal>   TSpectrum2 *s = new TSpectrum2();</p>
<p class=MsoNormal>   for (i = 0; i &lt; nbinsx; i++){</p>
<p class=MsoNormal>     for (j = 0; j &lt; nbinsy; j++){</p>
<p class=MsoNormal>                source[i][j] = search-&gt;GetBinContent(i +
1,j + 1); </p>
<p class=MsoNormal>             }</p>
<p class=MsoNormal>   }   </p>
<p class=MsoNormal>   nfound = s-&gt;SearchHighRes(source, dest, nbinsx,
nbinsy, 2, 5, kFALSE, 10, kFALSE, 1);   </p>
<p class=MsoNormal>   printf(&quot;Found %d candidate peaks\n&quot;,nfound);</p>
<p class=MsoNormal>   for(i=0;i&lt;nfound;i++)</p>
<p class=MsoNormal>             printf(&quot;posx= %d, posy= %d, value=
%d\n&quot;,(int)(fPositionX[i]+0.5), (int)(fPositionY[i]+0.5),
(int)source[(int)(fPositionX[i]+0.5)][(int)(fPositionY[i]+0.5)]);        </p>
<p class=MsoNormal>}</p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum2:StaticSearch" href="src/TSpectrum2.cxx.html#J2AZyB">StaticSearch</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</span><br />
<div class="funccomm"><pre>static function, interface to <a href="./TSpectrum2.html">TSpectrum2</a>::<a href="./TSpectrum2.html#TSpectrum2:Search" title="Int_t TSpectrum2::Search(const TH1* hist,Double_t sigma=2,Option_t* option=&quot;&quot;,Double_t threshold=0.05)">Search</a>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./TH1.html">TH1</a> * <a class="funcname" name="TSpectrum2:StaticBackground" href="src/TSpectrum2.cxx.html#mQwsTC">StaticBackground</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Int_t">Int_t</a> niter = 20, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</span><br />
<div class="funccomm"><pre>static function, interface to <a href="./TSpectrum2.html">TSpectrum2</a>::<a href="./TSpectrum2.html#TSpectrum2:Background" title="TH1* TSpectrum2::Background(const TH1* hist,int niter=20,Option_t* option=&quot;&quot;) or overloads">Background</a>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum2:TSpectrum2" href="src/TSpectrum2.h.html#r6DTzD">TSpectrum2</a>()</span><br />
</div>
<div class="funcdoc"><span class="funcname"><a href="./TH1.html">TH1</a>          * <a class="funcname" name="TSpectrum2:GetHistogram" href="src/TSpectrum2.h.html#SBAahC">GetHistogram</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum2.html#TSpectrum2:fHistogram" title="TH1* TSpectrum2::fHistogram">fHistogram</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum2:GetNPeaks" href="src/TSpectrum2.h.html#ZW6kIC">GetNPeaks</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum2.html#TSpectrum2:fNPeaks" title="Int_t TSpectrum2::fNPeaks">fNPeaks</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Float_t">Float_t</a>      * <a class="funcname" name="TSpectrum2:GetPositionX" href="src/TSpectrum2.h.html#XE9qIC">GetPositionX</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum2.html#TSpectrum2:fPositionX" title="Float_t* TSpectrum2::fPositionX">fPositionX</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Float_t">Float_t</a>      * <a class="funcname" name="TSpectrum2:GetPositionY" href="src/TSpectrum2.h.html#nwoqIC">GetPositionY</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum2.html#TSpectrum2:fPositionY" title="Float_t* TSpectrum2::fPositionY">fPositionY</a>;}</code></div>
<div style="clear:both;"></div>
</div>

<br />
<!--SIGNATURE-->
<div id="footer">
<em>&raquo; Author: <a href="http://consult.cern.ch/xwho/people?Miroslav+Morhac"> Miroslav Morhac   17/01/2006</a> </em><em>&raquo; Copyright   (C) 1995-2006, Rene Brun and Fons Rademakers.               *</em><br />
<em>&raquo; Last changed: root/spectrum:$Id: TSpectrum2.h 20882 2007-11-19 11:31:26Z rdm $ </em><em>&raquo; Last generated: 2011-11-03 20:23</em><br />
<em>This page has been automatically generated. For comments or suggestions regarding the documentation or ROOT in general please send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>.</em>
</div>
</div>
</body>
</html>
