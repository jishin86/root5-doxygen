<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!--                                             -->
<!-- Author: ROOT team (rootdev@pcroot.cern.ch)  -->
<!--                                             -->
<!--   Date: Thu Nov  3 20:23:08 2011            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>TSpectrum3</title>
<meta name="rating" content="General" />
<meta name="objecttype" content="Manual" />
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers, cern" />
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis." />
<link rel="stylesheet" type="text/css" href="ROOT.css" id="ROOTstyle" />
<script type="text/javascript" src="ROOT.js"></script>
</head>
<body  onload="javascript:SetValuesFromCookie();"><div id="body_content">
<div id="root_header"><img src="http://root.cern.ch/drupal/sites/default/files/rootdrawing-logo.png" alt="ROOT logo"/></div>
<a name="TopOfPage"></a>
<script type="text/javascript">WriteFollowPageBox('class TSpectrum3','libSpectrum','TSpectrum3.h');</script>
<div id="toplinks">
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Quick Links:</span>
<a class="descrheadentry" href="http://root.cern.ch">ROOT Homepage</a>
<a class="descrheadentry" href="./ClassIndex.html">Class Index</a>
<a class="descrheadentry" href="./ClassHierarchy.html">Class Hierarchy</a></div>
<script type="text/javascript">
function onSearch() {
var s='http://www.google.com/search?q=%s+site%3A%u+-site%3A%u%2Fsrc%2F+-site%3A%u%2Fexamples%2F';
var ref=String(document.location.href).replace(/https?:\/\//,'').replace(/\/[^\/]*$/,'').replace(/\//g,'%2F');
window.location.href=s.replace(/%u/ig,ref).replace(/%s/ig,escape(document.searchform.t.value));
return false;}
</script>
<form id="searchform" name="searchform" onsubmit="return onSearch()" action="javascript:onSearch();" method="post">
<input name="t" size="30" value="Search documentation..." onfocus="if (document.searchform.t.value=='Search documentation...') document.searchform.t.value='';"></input>
<a id="searchlink"  title="www.google.com"  href="javascript:onSearch();" onclick="return onSearch()">Search</a></form>
</div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Source:</span>
<a class="descrheadentry" href="src/TSpectrum3.h.html">header file</a>
<a class="descrheadentry" href="src/TSpectrum3.cxx.html">source file</a>
<a class="descrheadentry" href="http://root.cern.ch/viewcvs/trunk/hist/spectrum/inc/TSpectrum3.h?view=log">viewVC header</a> <a class="descrheadentry" href="http://root.cern.ch/viewcvs/trunk/hist/spectrum/src/TSpectrum3.cxx?view=log">viewVC source</a> 
</div></div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Sections:</span>
<a class="descrheadentry" href="#TSpectrum3:description">class description</a> 
<a class="descrheadentry" href="#TSpectrum3:Function_Members">function members</a>
<a class="descrheadentry" href="#TSpectrum3:Data_Members">data members</a>
<a class="descrheadentry" href="#TSpectrum3:Class_Charts">class charts</a>
</div></div>
</div>
<div class="location">
<a class="locationlevel" href="index.html">ROOT</a>
 &#187; <a class="locationlevel" href="./HIST_Index.html">HIST</a>
 &#187; <a class="locationlevel" href="./HIST_SPECTRUM_Index.html">SPECTRUM</a>
 &#187; <a class="locationlevel" href="#TopOfPage">TSpectrum3</a>
</div>
<div class="dropshadow"><div class="withshadow"><h1><a name="TSpectrum3:description"></a>class TSpectrum3: public <a href="./TNamed.html">TNamed</a></h1>
<div class="classdescr">
<pre>
THIS CLASS CONTAINS ADVANCED SPECTRA PROCESSING FUNCTIONS.

THREE-DIMENSIONAL BACKGROUND ESTIMATION FUNCTIONS
THREE-DIMENSIONAL SMOOTHING FUNCTIONS
THREE-DIMENSIONAL DECONVOLUTION FUNCTIONS
THREE-DIMENSIONAL PEAK SEARCH FUNCTIONS

These functions were written by:
Miroslav Morhac
Institute of Physics
Slovak Academy of Sciences
Dubravska cesta 9, 842 28 BRATISLAVA
SLOVAKIA

email:fyzimiro@savba.sk,    fax:+421 7 54772479

The original code in C has been repackaged as a C++ class by R.Brun

The algorithms in this class have been published in the following
references:
[1]  M.Morhac et al.: <a href="./TSpectrum3.html#TSpectrum3:Background" title="const char* TSpectrum3::Background(const TH1* hist,int niter,Option_t* option=&quot;goff&quot;) or overloads">Background</a> elimination methods for
multidimensional coincidence gamma-ray spectra. Nuclear
Instruments and Methods in Physics Research A 401 (1997) 113-
132.

[2]  M.Morhac et al.: Efficient one- and two-dimensional Gold
deconvolution and its application to gamma-ray spectra
decomposition. Nuclear Instruments and Methods in Physics
Research A 401 (1997) 385-408.

[3] M. Morhac et al.: Efficient algorithm of multidimensional
deconvolution and its application to nuclear data processing. Digital
Signal Processing, Vol. 13, No. 1, (2003), 144-171.

[4]  M.Morhac et al.: Identification of peaks in multidimensional
coincidence gamma-ray spectra. Nuclear Instruments and Methods in
Research Physics A  443(2000), 108-125.

These NIM papers are also available as Postscript files from:


   ftp://root.cern.ch/root/SpectrumDec.ps.gz
   ftp://root.cern.ch/root/SpectrumSrc.ps.gz
   ftp://root.cern.ch/root/SpectrumBck.ps.gz



</pre></div>
</div></div>

<div id="functions">
<h2><a id="TSpectrum3:Function_Members"></a>Function Members (Methods)</h2>
<div class="access" id="funcpubl"><b>public:</b>
<table class="func" id="tabfuncpubl" cellspacing="0">
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum3:TSpectrum3">TSpectrum3</a>()</td></tr>
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum3:TSpectrum3%2">TSpectrum3</a>(<span class="keyword">const</span> <a href="./TSpectrum3.html">TSpectrum3</a>&amp;)</td></tr>
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#TSpectrum3:TSpectrum3%1">TSpectrum3</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> maxpositions, <a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</td></tr>
<tr class="func"><td class="funcret"> virtual</td><td class="funcname"><a class="funcname" href="#TSpectrum3:_TSpectrum3">~TSpectrum3</a>()</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:AbstractMethod"><span class="baseclass">TObject::</span>AbstractMethod</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:AppendPad"><span class="baseclass">TObject::</span>AppendPad</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:Background">Background</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <span class="keyword">int</span> niter, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:Background%1">Background</a>(<span class="keyword">float</span>*** spectrum, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsX, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsY, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsZ, <a href="./ListOfTypes.html#Int_t">Int_t</a> direction, <a href="./ListOfTypes.html#Int_t">Int_t</a> filterType)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Browse"><span class="baseclass">TObject::</span>Browse</a>(<a href="./TBrowser.html">TBrowser</a>* b)</td></tr>
<tr class="func"><td class="funcret">static <a href="./TClass.html">TClass</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:Class">Class</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ClassName"><span class="baseclass">TObject::</span>ClassName</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Clear"><span class="baseclass">TNamed::</span>Clear</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Clone"><span class="baseclass">TNamed::</span>Clone</a>(<span class="keyword">const</span> <span class="keyword">char</span>* newname = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Compare"><span class="baseclass">TNamed::</span>Compare</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Copy"><span class="baseclass">TNamed::</span>Copy</a>(<a href="./TObject.html">TObject</a>&amp; named) <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:Deconvolution">Deconvolution</a>(<span class="keyword">float</span>*** source, <span class="keyword">const</span> <span class="keyword">float</span>*** resp, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterations, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberRepetitions, <a href="./ListOfTypes.html#Double_t">Double_t</a> boost)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Delete"><span class="baseclass">TObject::</span>Delete</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DistancetoPrimitive"><span class="baseclass">TObject::</span>DistancetoPrimitive</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Draw"><span class="baseclass">TObject::</span>Draw</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DrawClass"><span class="baseclass">TObject::</span>DrawClass</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DrawClone"><span class="baseclass">TObject::</span>DrawClone</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Dump"><span class="baseclass">TObject::</span>Dump</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Error"><span class="baseclass">TObject::</span>Error</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Execute"><span class="baseclass">TObject::</span>Execute</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* params, <a href="./ListOfTypes.html#Int_t">Int_t</a>* error = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Execute%1"><span class="baseclass">TObject::</span>Execute</a>(<a href="./TMethod.html">TMethod</a>* method, <a href="./TObjArray.html">TObjArray</a>* params, <a href="./ListOfTypes.html#Int_t">Int_t</a>* error = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ExecuteEvent"><span class="baseclass">TObject::</span>ExecuteEvent</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> event, <a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Fatal"><span class="baseclass">TObject::</span>Fatal</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:FillBuffer"><span class="baseclass">TNamed::</span>FillBuffer</a>(<span class="keyword">char</span>*&amp; buffer)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:FindObject"><span class="baseclass">TObject::</span>FindObject</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./TObject.html">TObject</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:FindObject%1"><span class="baseclass">TObject::</span>FindObject</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Option_t">Option_t</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetDrawOption"><span class="baseclass">TObject::</span>GetDrawOption</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <a href="./ListOfTypes.html#Long_t">Long_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetDtorOnly"><span class="baseclass">TObject::</span>GetDtorOnly</a>()</td></tr>
<tr class="func"><td class="funcret"><a href="./TH1.html">TH1</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:GetHistogram">GetHistogram</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetIconName"><span class="baseclass">TObject::</span>GetIconName</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:GetName"><span class="baseclass">TNamed::</span>GetName</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum3:GetNPeaks">GetNPeaks</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetObjectInfo"><span class="baseclass">TObject::</span>GetObjectInfo</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> px, <a href="./ListOfTypes.html#Int_t">Int_t</a> py) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetObjectStat"><span class="baseclass">TObject::</span>GetObjectStat</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Option_t">Option_t</a>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetOption"><span class="baseclass">TObject::</span>GetOption</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:GetPositionX">GetPositionX</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:GetPositionY">GetPositionY</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:GetPositionZ">GetPositionZ</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:GetTitle"><span class="baseclass">TNamed::</span>GetTitle</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#UInt_t">UInt_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:GetUniqueID"><span class="baseclass">TObject::</span>GetUniqueID</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:HandleTimer"><span class="baseclass">TObject::</span>HandleTimer</a>(<a href="./TTimer.html">TTimer</a>* timer)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#ULong_t">ULong_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Hash"><span class="baseclass">TNamed::</span>Hash</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Info"><span class="baseclass">TObject::</span>Info</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InheritsFrom"><span class="baseclass">TObject::</span>InheritsFrom</a>(<span class="keyword">const</span> <span class="keyword">char</span>* classname) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InheritsFrom%1"><span class="baseclass">TObject::</span>InheritsFrom</a>(<span class="keyword">const</span> <a href="./TClass.html">TClass</a>* cl) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Inspect"><span class="baseclass">TObject::</span>Inspect</a>() <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:InvertBit"><span class="baseclass">TObject::</span>InvertBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="func"><td class="funcret">virtual <a href="./TClass.html">TClass</a>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:IsA">IsA</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsEqual"><span class="baseclass">TObject::</span>IsEqual</a>(<span class="keyword">const</span> <a href="./TObject.html">TObject</a>* obj) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsFolder"><span class="baseclass">TObject::</span>IsFolder</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsOnHeap"><span class="baseclass">TObject::</span>IsOnHeap</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:IsSortable"><span class="baseclass">TNamed::</span>IsSortable</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:IsZombie"><span class="baseclass">TObject::</span>IsZombie</a>() <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:ls"><span class="baseclass">TNamed::</span>ls</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:MayNotUse"><span class="baseclass">TObject::</span>MayNotUse</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Notify"><span class="baseclass">TObject::</span>Notify</a>()</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Obsolete"><span class="baseclass">TObject::</span>Obsolete</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* asOfVers, <span class="keyword">const</span> <span class="keyword">char</span>* removedFromVers) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete"><span class="baseclass">TObject::</span>operator delete</a>(<span class="keyword">void</span>* ptr)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete%1"><span class="baseclass">TObject::</span>operator delete</a>(<span class="keyword">void</span>* ptr, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete[]"><span class="baseclass">TObject::</span>operator delete[]</a>(<span class="keyword">void</span>* ptr)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_delete[]%1"><span class="baseclass">TObject::</span>operator delete[]</a>(<span class="keyword">void</span>* ptr, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new"><span class="baseclass">TObject::</span>operator new</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new%1"><span class="baseclass">TObject::</span>operator new</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz, <span class="keyword">void</span>* vp)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new[]"><span class="baseclass">TObject::</span>operator new[]</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span>*</td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:operator_new[]%1"><span class="baseclass">TObject::</span>operator new[]</a>(<a href="./ListOfTypes.html#size_t">size_t</a> sz, <span class="keyword">void</span>* vp)</td></tr>
<tr class="func"><td class="funcret"><a href="./TSpectrum3.html">TSpectrum3</a>&amp;</td><td class="funcname"><a class="funcname" href="#TSpectrum3:operator_">operator=</a>(<span class="keyword">const</span> <a href="./TSpectrum3.html">TSpectrum3</a>&amp;)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Paint"><span class="baseclass">TObject::</span>Paint</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Pop"><span class="baseclass">TObject::</span>Pop</a>()</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum3:Print">Print</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Read"><span class="baseclass">TObject::</span>Read</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:RecursiveRemove"><span class="baseclass">TObject::</span>RecursiveRemove</a>(<a href="./TObject.html">TObject</a>* obj)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:ResetBit"><span class="baseclass">TObject::</span>ResetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SaveAs"><span class="baseclass">TObject::</span>SaveAs</a>(<span class="keyword">const</span> <span class="keyword">char</span>* filename = <span class="string">""</span>, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) <span class="keyword">const</span><span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SavePrimitive"><span class="baseclass">TObject::</span>SavePrimitive</a>(<a href="./ListOfTypes.html#ostream">ostream</a>&amp; out, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)</td></tr>
<tr class="func"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum3:Search">Search</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum3:SearchFast">SearchFast</a>(<span class="keyword">const</span> <span class="keyword">float</span>*** source, <span class="keyword">float</span>*** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</td></tr>
<tr class="func"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="#TSpectrum3:SearchHighRes">SearchHighRes</a>(<span class="keyword">const</span> <span class="keyword">float</span>*** source, <span class="keyword">float</span>*** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> backgroundRemove, <a href="./ListOfTypes.html#Int_t">Int_t</a> deconIterations, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetBit%1"><span class="baseclass">TObject::</span>SetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f)</td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetBit"><span class="baseclass">TObject::</span>SetBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> set)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetDrawOption"><span class="baseclass">TObject::</span>SetDrawOption</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetDtorOnly"><span class="baseclass">TObject::</span>SetDtorOnly</a>(<span class="keyword">void</span>* obj)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetName"><span class="baseclass">TNamed::</span>SetName</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetNameTitle"><span class="baseclass">TNamed::</span>SetNameTitle</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name, <span class="keyword">const</span> <span class="keyword">char</span>* title)</td></tr>
<tr class="funcinh"><td class="funcret">static <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetObjectStat"><span class="baseclass">TObject::</span>SetObjectStat</a>(<a href="./ListOfTypes.html#Bool_t">Bool_t</a> stat)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum3:SetResolution">SetResolution</a>(<a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:SetTitle"><span class="baseclass">TNamed::</span>SetTitle</a>(<span class="keyword">const</span> <span class="keyword">char</span>* title = <span class="string">""</span>)<span class="funcprop"><abbr title="has a popup menu entry">MENU</abbr> </span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SetUniqueID"><span class="baseclass">TObject::</span>SetUniqueID</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> uid)</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum3:ShowMembers">ShowMembers</a>(<a href="./TMemberInspector.html">TMemberInspector</a>&amp; insp)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TNamed.html#TNamed:Sizeof"><span class="baseclass">TNamed::</span>Sizeof</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><span class="keyword">const</span> <span class="keyword">char</span>*</td><td class="funcname"><a class="funcname" href="#TSpectrum3:SmoothMarkov">SmoothMarkov</a>(<span class="keyword">float</span>*** source, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</td></tr>
<tr class="func"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum3:Streamer">Streamer</a>(<a href="./TBuffer.html">TBuffer</a>&amp; b)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#TSpectrum3:StreamerNVirtual">StreamerNVirtual</a>(<a href="./TBuffer.html">TBuffer</a>&amp; b)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:SysError"><span class="baseclass">TObject::</span>SysError</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Bool_t">Bool_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:TestBit"><span class="baseclass">TObject::</span>TestBit</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:TestBits"><span class="baseclass">TObject::</span>TestBits</a>(<a href="./ListOfTypes.html#UInt_t">UInt_t</a> f) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:UseCurrentStyle"><span class="baseclass">TObject::</span>UseCurrentStyle</a>()</td></tr>
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Warning"><span class="baseclass">TObject::</span>Warning</a>(<span class="keyword">const</span> <span class="keyword">char</span>* method, <span class="keyword">const</span> <span class="keyword">char</span>* msgfmt) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Write"><span class="baseclass">TObject::</span>Write</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> option = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> bufsize = 0)</td></tr>
<tr class="funcinh"><td class="funcret">virtual <a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:Write%1"><span class="baseclass">TObject::</span>Write</a>(<span class="keyword">const</span> <span class="keyword">char</span>* name = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> option = 0, <a href="./ListOfTypes.html#Int_t">Int_t</a> bufsize = 0) <span class="keyword">const</span></td></tr>

</table></div>
<div class="access" id="funcprot"><b>protected:</b>
<table class="func" id="tabfuncprot" cellspacing="0">
<tr class="funcinh"><td class="funcret">virtual <span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:DoError"><span class="baseclass">TObject::</span>DoError</a>(<span class="keyword">int</span> level, <span class="keyword">const</span> <span class="keyword">char</span>* location, <span class="keyword">const</span> <span class="keyword">char</span>* fmt, va_list va) <span class="keyword">const</span></td></tr>
<tr class="funcinh"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="./TObject.html#TObject:MakeZombie"><span class="baseclass">TObject::</span>MakeZombie</a>()</td></tr>

</table></div>
</div>

<div id="datamembers">
<h2><a name="TSpectrum3:Data_Members"></a>Data Members</h2>
<div class="access" id="enumpubl"><b>public:</b>
<table class="data" id="tabenumpubl" cellspacing="0">
<tr class="data"><td class="datatype">enum  { </td><td class="dataname"><a name="TSpectrum3:kBackIncreasingWindow"></a>kBackIncreasingWindow</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum3:kBackDecreasingWindow"></a>kBackDecreasingWindow</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum3:kBackSuccessiveFiltering"></a>kBackSuccessiveFiltering</td><td></td></tr>
<tr class="data"><td class="datatype"></td><td class="dataname"><a name="TSpectrum3:kBackOneStepFiltering"></a>kBackOneStepFiltering</td><td></td></tr>
<tr class="data"><td class="datatype">};</td><td></td><td></td></tr>
<tr class="datainh"><td class="datatype">enum <span class="baseclass">TObject::</span>EStatusBits { </td><td class="dataname"><a href="./TObject.html#TObject:kCanDelete">kCanDelete</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kMustCleanup">kMustCleanup</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kObjInCanvas">kObjInCanvas</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kIsReferenced">kIsReferenced</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kHasUUID">kHasUUID</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kCannotPick">kCannotPick</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kNoContextMenu">kNoContextMenu</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kInvalidObject">kInvalidObject</a></td><td></td></tr>
<tr class="datainh"><td class="datatype">};</td><td></td><td></td></tr>
<tr class="datainh"><td class="datatype">enum <span class="baseclass">TObject::</span><i>[unnamed]</i> { </td><td class="dataname"><a href="./TObject.html#TObject:kIsOnHeap">kIsOnHeap</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kNotDeleted">kNotDeleted</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kZombie">kZombie</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kBitMask">kBitMask</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kSingleKey">kSingleKey</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kOverwrite">kOverwrite</a></td><td></td></tr>
<tr class="datainh"><td class="datatype"></td><td class="dataname"><a href="./TObject.html#TObject:kWriteDelete">kWriteDelete</a></td><td></td></tr>
<tr class="datainh"><td class="datatype">};</td><td></td><td></td></tr>

</table></div>
<div class="access" id="dataprot"><b>protected:</b>
<table class="data" id="tabdataprot" cellspacing="0">
<tr class="data"><td class="datatype"><a href="./TH1.html">TH1</a>*</td><td class="dataname"><a name="TSpectrum3:fHistogram"></a>fHistogram</td><td class="datadesc">resulting histogram</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum3:fMaxPeaks"></a>fMaxPeaks</td><td class="datadesc">Maximum number of peaks to be found</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Int_t">Int_t</a></td><td class="dataname"><a name="TSpectrum3:fNPeaks"></a>fNPeaks</td><td class="datadesc">number of peaks found</td></tr>
<tr class="datainh"><td class="datatype"><a href="./TString.html">TString</a></td><td class="dataname"><a href="./TNamed.html#TNamed:fName"><span class="baseclass">TNamed::</span>fName</a></td><td class="datadesc">object identifier</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum3:fPosition"></a>fPosition</td><td class="datadesc">[fNPeaks] array of current peak positions</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum3:fPositionX"></a>fPositionX</td><td class="datadesc">[fNPeaks] X positions of peaks</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum3:fPositionY"></a>fPositionY</td><td class="datadesc">[fNPeaks] Y positions of peaks</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a>*</td><td class="dataname"><a name="TSpectrum3:fPositionZ"></a>fPositionZ</td><td class="datadesc">[fNPeaks] Z positions of peaks</td></tr>
<tr class="data"><td class="datatype"><a href="./ListOfTypes.html#Float_t">Float_t</a></td><td class="dataname"><a name="TSpectrum3:fResolution"></a>fResolution</td><td class="datadesc">resolution of the neighboring peaks</td></tr>
<tr class="datainh"><td class="datatype"><a href="./TString.html">TString</a></td><td class="dataname"><a href="./TNamed.html#TNamed:fTitle"><span class="baseclass">TNamed::</span>fTitle</a></td><td class="datadesc">object title</td></tr>

</table></div>
</div>
<h2><a id="TSpectrum3:Class_Charts"></a>Class Charts</h2>
<map name="MapTSpectrum3_Inh" id="MapTSpectrum3_Inh">
<area shape="rect" href="./TNamed.html" title="TNamed" alt="" coords="308,12,411,41"/>
<area shape="rect" href="./TObject.html" title="TObject" alt="" coords="44,12,140,41"/>
</map>
<map name="MapTSpectrum3_InhMem" id="MapTSpectrum3_InhMem">
<area shape="rect" href="./TNamed.html" alt="" coords="344,60,629,109"/>
<area shape="rect" href="./TNamed.html" alt="" coords="541,120,629,297"/>
<area shape="rect" href="./TNamed.html" alt="" coords="443,120,531,297"/>
<area shape="rect" href="./TNamed.html" alt="" coords="344,120,432,297"/>
<area shape="rect" href="./TNamed.html" title="TNamed" alt="" coords="333,16,640,308"/>
<area shape="rect" href="./TObject.html" alt="" coords="224,60,312,183"/>
<area shape="rect" href="./TObject.html" alt="" coords="125,60,213,197"/>
<area shape="rect" href="./TObject.html" alt="" coords="27,60,115,197"/>
<area shape="rect" href="./TObject.html" alt="" coords="256,193,280,228"/>
<area shape="rect" href="./TObject.html" alt="" coords="224,239,312,665"/>
<area shape="rect" href="./TObject.html" alt="" coords="125,224,213,665"/>
<area shape="rect" href="./TObject.html" alt="" coords="27,224,115,665"/>
<area shape="rect" href="./TObject.html" title="TObject" alt="" coords="16,16,323,676"/>
</map>
<map name="MapTSpectrum3_Lib" id="MapTSpectrum3_Lib">
<area shape="rect" href="LibraryDependencies.html" title="All Libraries" alt="" coords="463,121,591,169"/>
</map>
<div class="tabs">
<a id="imgTSpectrum3_Inh" class="tabsel" href="inh/TSpectrum3_Inh.png" onclick="javascript:return SetImg('Charts','inh/TSpectrum3_Inh.png');">Inheritance</a>
<a id="imgTSpectrum3_InhMem" class="tab" href="inhmem/TSpectrum3_InhMem.png" onclick="javascript:return SetImg('Charts','inhmem/TSpectrum3_InhMem.png');">Inherited Members</a>
<a id="imgTSpectrum3_Incl" class="tab" href="incl/TSpectrum3_Incl.png" onclick="javascript:return SetImg('Charts','incl/TSpectrum3_Incl.png');">Includes</a>
<a id="imgTSpectrum3_Lib" class="tab" href="lib/TSpectrum3_Lib.png" onclick="javascript:return SetImg('Charts','lib/TSpectrum3_Lib.png');">Libraries</a><br/>
</div><div class="classcharts"><div class="classchartswidth"></div>
<img id="Charts" alt="Class Charts" class="classcharts" usemap="#MapTSpectrum3_Inh" src="inh/TSpectrum3_Inh.png"/></div>
<h2>Function documentation</h2>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum3:TSpectrum3" href="src/TSpectrum3.cxx.html#rM5DUC">TSpectrum3</a>()</span><br />
<div class="funccomm"><pre> Constructor.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum3:TSpectrum3%1" href="src/TSpectrum3.cxx.html#AhOtsC">TSpectrum3</a>(<a href="./ListOfTypes.html#Int_t">Int_t</a> maxpositions, <a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</span><br />
<div class="funccomm"><pre>  maxpositions:  maximum number of peaks
  resolution:    determines resolution of the neighboring peaks
                 default value is 1 correspond to 3 sigma distance
                 between peaks. Higher values allow higher resolution
                 (smaller distance between peaks.
                 May be set later through <a href="./TSpectrum3.html#TSpectrum3:SetResolution" title="void TSpectrum3::SetResolution(Float_t resolution=1)">SetResolution</a>.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum3:_TSpectrum3" href="src/TSpectrum3.cxx.html#CGLD3C">~TSpectrum3</a>()</span><br />
<div class="funccomm"><pre> Destructor.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span> * <a class="funcname" name="TSpectrum3:Background" href="src/TSpectrum3.cxx.html#mAzQHD">Background</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <span class="keyword">int</span> niter, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>)</span><br />
<div class="funccomm"><pre>
ONE-DIMENSIONAL BACKGROUND ESTIMATION FUNCTION
This function calculates background spectrum from source in h.
The result is placed in the vector pointed by spectrum pointer.

Function parameters:
spectrum:  pointer to the vector of source spectrum
size:      length of spectrum and working space vectors
number_of_iterations, for details we refer to manual


</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum3:Print" href="src/TSpectrum3.cxx.html#q0EPgE">Print</a>(<a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">""</span>) const</span><br />
<div class="funccomm"><pre> <a href="./TSpectrum3.html#TSpectrum3:Print" title="void TSpectrum3::Print(Option_t* option=&quot;&quot;)">Print</a> the array of positions
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum3:Search" href="src/TSpectrum3.cxx.html#w3uhtB">Search</a>(<span class="keyword">const</span> <a href="./TH1.html">TH1</a>* hist, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma = 2, <a href="./ListOfTypes.html#Option_t">Option_t</a>* option = <span class="string">"goff"</span>, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold = 0.05)</span><br />
<div class="funccomm"><pre>
ONE-DIMENSIONAL PEAK SEARCH FUNCTION
This function searches for peaks in source spectrum in hin
The number of found peaks and their positions are written into
the members fNpeaks and <a href="./TSpectrum3.html#TSpectrum3:fPositionX" title="Float_t* TSpectrum3::fPositionX">fPositionX</a>.

Function parameters:
hin:       pointer to the histogram of source spectrum
sigma:   sigma of searched peaks, for details we refer to manual
Note that sigma is in number of bins
threshold: (default=0.05)  peaks with amplitude less than
threshold*highest_peak are discarded.

if option is not equal to <span class="string">"goff"</span> (goff is the default), then
a polymarker object is created and added to the list of functions of
the histogram. The histogram is drawn with the specified option and
the polymarker object drawn on top of the histogram.
The polymarker coordinates correspond to the npeaks peaks found in
the histogram.
A pointer to the polymarker object can be retrieved later via:
<a href="./TList.html">TList</a> *functions = hin-&gt;GetListOfFunctions();
<a href="./TPolyMarker.html">TPolyMarker</a> *pm = (<a href="./TPolyMarker.html">TPolyMarker</a>*)functions-&gt;<a href="./TObject.html#TObject:FindObject" title="TObject* TObject::FindObject(const char* name) or overloads">FindObject</a>(<span class="string">"TPolyMarker"</span>)


</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="TSpectrum3:SetResolution" href="src/TSpectrum3.cxx.html#JxxaAE">SetResolution</a>(<a href="./ListOfTypes.html#Float_t">Float_t</a> resolution = 1)</span><br />
<div class="funccomm"><pre>  resolution: determines resolution of the neighboring peaks
              default value is 1 correspond to 3 sigma distance
              between peaks. Higher values allow higher resolution
              (smaller distance between peaks.
              May be set later through <a href="./TSpectrum3.html#TSpectrum3:SetResolution" title="void TSpectrum3::SetResolution(Float_t resolution=1)">SetResolution</a>.
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span> * <a class="funcname" name="TSpectrum3:Background%1" href="src/TSpectrum3.cxx.html#MRmB1">Background</a>(<span class="keyword">float</span>*** spectrum, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsX, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsY, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterationsZ, <a href="./ListOfTypes.html#Int_t">Int_t</a> direction, <a href="./ListOfTypes.html#Int_t">Int_t</a> filterType)</span><br />
<div class="funccomm"><pre>
THREE-DIMENSIONAL BACKGROUND ESTIMATION FUNCTIONS
This function calculates background spectrum from source spectrum.
The result is placed to the array pointed by spectrum pointer.

Function parameters:
spectrum-pointer to the array of source spectrum
ssizex-x length of spectrum
ssizey-y length of spectrum
ssizez-z length of spectrum
numberIterationsX-maximal x width of clipping window
numberIterationsY-maximal y width of clipping window
numberIterationsZ-maximal z width of clipping window
for details we refer to manual
direction- direction of change of clipping window
- possible values=<a href="./TSpectrum3.html#TSpectrum3:kBackIncreasingWindow" title="const enum TSpectrum3:: TSpectrum3::kBackIncreasingWindow">kBackIncreasingWindow</a>
<a href="./TSpectrum3.html#TSpectrum3:kBackDecreasingWindow" title="const enum TSpectrum3:: TSpectrum3::kBackDecreasingWindow">kBackDecreasingWindow</a>
filterType-determines the algorithm of the filtering
-possible values=<a href="./TSpectrum3.html#TSpectrum3:kBackSuccessiveFiltering" title="const enum TSpectrum3:: TSpectrum3::kBackSuccessiveFiltering">kBackSuccessiveFiltering</a>
<a href="./TSpectrum3.html#TSpectrum3:kBackOneStepFiltering" title="const enum TSpectrum3:: TSpectrum3::kBackOneStepFiltering">kBackOneStepFiltering</a>




</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section1>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:14.0pt'>Background
estimation</span></b></p>
<p class=MsoNormal style='text-align:justify'><i>&nbsp;</i></p>
<p class=MsoNormal style='text-align:justify'><i>Goal: Separation of useful
information (peaks) from useless information (background)</i> </p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>method is based on Sensitive Nonlinear Iterative Peak (SNIP) clipping
algorithm [1]</p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>there exist two algorithms for the estimation of new value in the
channel <sub><img width=43 height=24 src="gif/spectrum3_background_image001.gif"></sub></p>
<p class=MsoNormal style='margin-left:18.0pt;text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><i>Algorithm based on Successive
Comparisons</i></p>
<p class=MsoNormal style='text-align:justify'>It is an extension of
one-dimensional SNIP algorithm to another dimension. For details we refer to
[2].</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><i>Algorithm based on One Step
Filtering</i></p>
<p class=MsoNormal style='text-align:justify'>The algorithm is analogous to
that for 2-dimensional data. For details we refer to TSpectrum2. New value in
the estimated channel is calculated as</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><sub><img width=103 height=26
src="gif/spectrum3_background_image002.gif"></sub></p>
<p class=MsoNormal style='text-align:justify'><sub><img width=621 height=408
src="gif/spectrum3_background_image003.gif"></sub><sub><img width=148 height=27
src="gif/spectrum3_background_image004.gif"></sub></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>where p = 1, 2, ,
number_of_iterations. </p>
<p class=MsoNormal><i>&nbsp;</i></p>
<p class=MsoNormal><i>Function:</i></p>
<p class=MsoNormal style='text-align:justify'><b>const <a
href="http://root.cern.ch/root/html/ListOfTypes.html#char" target="_parent">char</a>*
</b><a href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum3::Background</b></a><b>
(<a href="http://root.cern.ch/root/html/ListOfTypes.html#float" target="_parent">float</a>
***fSpectrum, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fSizex, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
fSizey, int fSizez, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fNumberIterationsX, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
fNumberIterationsY, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fNumberIterationsZ, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
fDirection, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fFilterType) </b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>This function calculates
background spectrum from the source spectrum. The result is placed in the matrix
pointed by fSpectrum pointer. One can also switch the direction of the change
of the clipping window and to select one of the two above given algorithms. On
successful completion it returns 0. On error it returns pointer to the string
describing error.</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='color:red'>Parameters:</span></i></p>
<p class=MsoNormal> <b>fSpectrum</b>-pointer to the matrix of source
spectrum </p>
<p class=MsoNormal> <b>fSizex, fSizey, fSizez </b>-lengths of the
spectrum matrix </p>
<p class=MsoNormal style='text-align:justify'> <b>fNumberIterationsX,
fNumberIterationsY, fNumberIterationsZ </b>maximal</p>
<p class=MsoNormal style='text-align:justify'> widths of clipping window,
</p>
<p class=MsoNormal> <b>fDirection</b>- direction of change of clipping
window </p>
<p class=MsoNormal> - possible
values=kBackIncreasingWindow </p>
<p class=MsoNormal>
kBackDecreasingWindow </p>
<p class=MsoNormal> <b>fFilterType</b>-type of the clipping algorithm,
</p>
<p class=MsoNormal> -possible values=kBack SuccessiveFiltering</p>
<p class=MsoNormal>
kBackOneStepFiltering </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i>References:</i></b></p>
<p class=MsoNormal style='text-align:justify'>[1] C. G Ryan et al.: SNIP, a
statistics-sensitive background treatment for the quantitative analysis of PIXE
spectra in geoscience applications. NIM, B34 (1988), 396-402.</p>
<p class=MsoNormal style='text-align:justify'>[2] <span lang=SK>M.
Morh&#269;, J. Kliman, V. Matouek, M. Veselsk, I. Turzo</span>.: Background
elimination methods for multidimensional gamma-ray spectra. NIM, A401 (1997)
113-132.</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><i>Example 1 script Back3.c :</i></p>
<p class=MsoNormal><i><span style='font-size:18.0pt'><img border=0 width=601
height=368 src="gif/spectrum3_background_image005.jpg"></span></i></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 1 Original three-dimensional
gamma-gamma-gamma-ray spectrum</b></p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=601 height=368 src="gif/spectrum3_background_image006.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 2 Background estimated
from data from Fig. 1 using decreasing clipping window with widths 5, 5, 5 and
algorithm based on successive comparisons. The estimate includes not only
continuously changing background but also one- and two-dimensional ridges.</b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt;color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='font-size:14.0pt;color:green'><img border=0
width=601 height=368 src="gif/spectrum3_background_image007.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 3 Resulting peaks after
subtraction of the estimated background (Fig. 2) from original three-dimensional
gamma-gamma-gamma-ray spectrum (Fig. 1).</b></p>
<p class=MsoNormal><b><span style='color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='color:green'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='color:green'>Script:</span></b></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// Example to illustrate the
background estimator (class TSpectrum3).</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// To execute this example,
do</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// root &gt; .x Back3.C</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>void Back3() {</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Int_t i, j, k;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span><span lang=FR
style='font-size:10.0pt'>Int_t nbinsx = 64;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsy = 64;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsz =
64; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmax =
nbinsx;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymax =
nbinsy; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t zmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>Int_t zmax = nbinsz; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** source = new
float **[nbinsx];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** dest = new float
**[nbinsx]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j]=new
float [nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> dest[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> dest[i][j]=new float
[nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *back = new
TH3F(&quot;back&quot;,&quot;Background
estimation&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TFile *f = new
TFile(&quot;TSpectrum3.root&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> back=(TH3F*)
f-&gt;Get(&quot;back;1&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TCanvas *Background = new
TCanvas(&quot;Background&quot;,&quot;Estimation of background with decreasing
window&quot;,10,10,1000,700);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TSpectrum3 *s = new
TSpectrum3();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  for (k = 0;
k &lt; nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  source[i][j][k]
= back-&gt;GetBinContent(i + 1,j + 1,k + 1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  dest[i][j][k]
= back-&gt;GetBinContent(i + 1,j + 1,k + 1);  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
s-&gt;Background(dest,nbinsx,nbinsy,nbinsz,5,5,5,s-&gt;kBackDecreasingWindow,s-&gt;kBackSuccessiveFiltering);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
back-&gt;SetBinContent(i + 1,j + 1,k + 1, dest[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> FILE *out;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> char PATH[80]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
strcpy(PATH,&quot;spectra3\\back_output_5ds.spe&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> out=fopen(PATH,&quot;wb&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++){  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> fwrite(dest[i][j],
sizeof(dest[0][0][0]),nbinsz,out);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> fclose(out); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j][k] =
source[i][j][k] - dest[i][j][k];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
back-&gt;SetBinContent(i + 1,j + 1,k + 1, source[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
strcpy(PATH,&quot;spectra3\\back_peaks_5ds.spe&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
out=fopen(PATH,&quot;wb&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++){  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> fwrite(source[i][j],
sizeof(source[0][0][0]),nbinsz,out);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> fclose(out); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
back-&gt;Draw(&quot;&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>}</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span>* <a class="funcname" name="TSpectrum3:SmoothMarkov" href="src/TSpectrum3.cxx.html#a0eSXE">SmoothMarkov</a>(<span class="keyword">float</span>*** source, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</span><br />
<div class="funccomm"><pre>
THREE-DIMENSIONAL MARKOV SPECTRUM SMOOTHING FUNCTION

This function calculates smoothed spectrum from source spectrum
based on Markov chain method.
The result is placed in the array pointed by spectrum pointer.

Function parameters:
source-pointer to the array of source spectrum
working_space-pointer to the working array
ssizex-x length of spectrum and working space arrays
ssizey-y length of spectrum and working space arrays
ssizey-z length of spectrum and working space arrays
averWindow-width of averaging smoothing window



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section2>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:14.0pt'>Smoothing</span></b></p>
<p class=MsoNormal style='text-align:justify'><i>&nbsp;</i></p>
<p class=MsoNormal><i>Goal: Suppression of statistical fluctuations</i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>the algorithm is based on discrete Markov chain, which has very simple
invariant distribution</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal> <sub><img width=404 height=42
src="Smoothing_files/image001.gif"></sub><span style='font-family:Arial'></span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-family:Arial'>
</span><sub><img width=22 height=28 src="Smoothing_files/image002.gif"></sub><span
style='font-family:Arial'></span>being defined from the normalization
condition <sub><img width=50 height=37 src="Smoothing_files/image003.gif"></sub></p>
<p class=MsoNormal> n is the length of the smoothed spectrum and </p>
<p class=MsoNormal>
<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=65 height=9></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=205 height=48 src="Smoothing_files/image004.gif"></td>
 </tr>
</table>
 &nbsp;</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<br clear=ALL>
<p class=MsoNormal style='margin-left:34.2pt;text-align:justify'>is the
probability of the change of the peak position from channel i to the channel
i+1. <sub><img width=24 height=31 src="Smoothing_files/image005.gif"></sub>is
the normalization constant so that <sub><img width=99 height=25
src="Smoothing_files/image006.gif"></sub>and m is a width of smoothing window.
We have extended this algorithm to three dimensions. </p>
<p class=MsoNormal><i>&nbsp;</i></p>
<p class=MsoNormal><i>Function:</i></p>
<p class=MsoNormal><b>const <a
href="http://root.cern.ch/root/html/ListOfTypes.html#char" target="_parent">char</a>*
</b><a href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum3::SmoothMarkov</b></a><b>(<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float" target="_parent">float</a>
***fSpectrum, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fSizex, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
fSizey, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int"
target="_parent">int</a> fSizey, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#int" target="_parent">int</a>
fAverWindow) </b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>This function calculates smoothed
spectrum from the source spectrum based on Markov chain method. The result is
placed in the field pointed by source pointer. On successful completion it
returns 0. On error it returns pointer to the string describing error.</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='color:red'>Parameters:</span></i></p>
<p class=MsoNormal> <b>fSpectrum</b>-pointer to the matrix of source
spectrum </p>
<p class=MsoNormal> <b>fSizex, fSizey, fSizez</b> -lengths of the
spectrum matrix </p>
<p class=MsoNormal> <b>fAverWindow</b>-width of averaging smoothing
window </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i>Reference:</i></b></p>
<p class=MsoNormal style='text-align:justify'>[1] Z.K. Silagadze, A new
algorithm for automatic photopeak searches. NIM A 376 (1996), 451<b>.</b> </p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal><i>Example 1  script SmootMarkov3.c :</i></p>
<p class=MsoNormal><i><img border=0 width=601 height=368
src="Smoothing_files/image007.jpg"></i><b>Fig. 1 Original noisy spectrum. </b></p>
<p class=MsoNormal><b><img border=0 width=601 height=368
src="Smoothing_files/image008.jpg"></b></p>
<p class=MsoNormal><b>Fig. 2 Smoothed spectrum with averaging window m=3.</b></p>
<p class=MsoNormal><b><span style='color:#339966'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='color:#339966'>Script:</span></b></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// Example to illustrate the
Markov smoothing (class TSpectrum3).</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// To execute this example,
do</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// root &gt; .x
SmoothMarkov3.C</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'>void SmoothMarkov3()
{</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t i, j, k;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsx = 64;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsy = 64;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsz =
64; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmax =
nbinsx;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymax =
nbinsy; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t zmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>Int_t zmax = nbinsz; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** source = new
float **[nbinsx];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j]=new
float [nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *sm = new
TH3F(&quot;Smoothing&quot;,&quot;Markov
smoothing&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TFile *f = new
TFile(&quot;TSpectrum3.root&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> sm=(TH3F*)
f-&gt;Get(&quot;back;1&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TCanvas *Background = new
TCanvas(&quot;Smoothing&quot;,&quot;Markov smoothing&quot;,10,10,1000,700);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TSpectrum3 *s = new
TSpectrum3();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  for (k = 0;
k &lt; nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  source[i][j][k]
= sm-&gt;GetBinContent(i + 1,j + 1,k + 1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
s-&gt;SmoothMarkov(source,nbinsx,nbinsy,nbinsz,3);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
sm-&gt;SetBinContent(i + 1,j + 1,k + 1, source[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
sm-&gt;Draw(&quot;&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>}</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">const</span> <span class="keyword">char</span> * <a class="funcname" name="TSpectrum3:Deconvolution" href="src/TSpectrum3.cxx.html#S7ZnmD">Deconvolution</a>(<span class="keyword">float</span>*** source, <span class="keyword">const</span> <span class="keyword">float</span>*** resp, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberIterations, <a href="./ListOfTypes.html#Int_t">Int_t</a> numberRepetitions, <a href="./ListOfTypes.html#Double_t">Double_t</a> boost)</span><br />
<div class="funccomm"><pre>
THREE-DIMENSIONAL DECONVOLUTION FUNCTION
This function calculates deconvolution from source spectrum
according to response spectrum
The result is placed in the cube pointed by source pointer.

Function parameters:
source-pointer to the cube of source spectrum
resp-pointer to the cube of response spectrum
ssizex-x length of source and response spectra
ssizey-y length of source and response spectra
ssizey-y length of source and response spectra
numberIterations, for details we refer to manual
numberRepetitions, for details we refer to manual
boost, boosting factor, for details we refer to manual



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section3>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:14.0pt'>Deconvolution</span></b></p>
<p class=MsoNormal style='text-align:justify'><i>&nbsp;</i></p>
<p class=MsoNormal style='text-align:justify'><i>Goal: Improvement of the
resolution in spectra, decomposition of multiplets</i></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>Mathematical formulation of the 3-dimensional convolution
system is</p>
<p class=MsoNormal style='margin-left:18.0pt'>
<table cellpadding=0 cellspacing=0 align=left>
 <tr>
  <td width=69 height=1></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=334 height=67 src="gif/spectrum3_deconvolution_image001.gif"></td>
 </tr>
</table>
<span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal>&nbsp;</p>
<br clear=ALL>
<p class=MsoNormal>where h(i,j,k) is the impulse response function, x, y are
input and output fields, respectively, <sub><img width=69 height=24
src="gif/spectrum3_deconvolution_image002.gif"></sub>, are the lengths of x and h fields<i>
</i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>let us assume that we know the response and the output fields (spectra)
of the above given system. </p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>the deconvolution represents solution of the overdetermined system of
linear equations, i.e., the calculation of the field <b>x.</b></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>from numerical stability point of view the operation of deconvolution is
extremely critical (ill-posed problem) as well as time consuming operation. </p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>the Gold deconvolution algorithm proves to work very well even for
2-dimensional systems. Generalization of the algorithm for 2-dimensional
systems was presented in [1], and for multidimensional systems in [2].</p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>for Gold deconvolution algorithm as well as for boosted deconvolution
algorithm we refer also to TSpectrum and TSpectrum2 </p>
<p class=MsoNormal><i>&nbsp;</i></p>
<p class=MsoNormal><i>Function:</i></p>
<p class=MsoNormal style='text-align:justify'><b>const <a
href="http://root.cern.ch/root/html/ListOfTypes.html#char">char</a>* </b><a
name="TSpectrum:Deconvolution1"></a><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum3::Deconvolution</b></a><b>(<a
href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a> ***fSource,
const <a href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a>
***fResp, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizex, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizey, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizez, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fNumberIterations, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fNumberRepetitions, <a
href="http://root.cern.ch/root/html/ListOfTypes.html#double">double</a> fBoost)</b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>This function calculates
deconvolution from source spectrum according to response spectrum using Gold
deconvolution algorithm. The result is placed in the field pointed by source
pointer. On successful completion it returns 0. On error it returns pointer to
the string describing error. If desired after every fNumberIterations one can apply
boosting operation (exponential function with exponent given by fBoost
coefficient) and repeat it fNumberRepetitions times.</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='color:red'>Parameters:</span></i></p>
<p class=MsoNormal> <b>fSource</b>-pointer to the matrix of source
spectrum </p>
<p class=MsoNormal> <b>fResp</b>-pointer to the matrix of response
spectrum </p>
<p class=MsoNormal> <b>fSizex, fSizey, fSizez</b> -lengths of the
spectrum matrix </p>
<p class=MsoNormal style='text-align:justify'> <b>fNumberIterations</b>-number
of iterations </p>
<p class=MsoNormal style='text-align:justify'> <b>fNumberRepetitions</b>-number
of repetitions for boosted deconvolution. It must be </p>
<p class=MsoNormal style='text-align:justify'> greater or equal to one.</p>
<p class=MsoNormal style='text-align:justify'> <b>fBoost</b>-boosting
coefficient, applies only if fNumberRepetitions is greater than one. </p>
<p class=MsoNormal style='text-align:justify'> <span style='color:fuchsia'>Recommended
range &lt;1,2&gt;.</span></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i>References:</i></b></p>
<p class=MsoNormal style='text-align:justify'>[1] <span lang=SK>M.
Morh&#269;, J. Kliman, V. Matouek, M. Veselsk, I. Turzo</span>.: Efficient
one- and two-dimensional Gold deconvolution and its application to gamma-ray
spectra decomposition. NIM, A401 (1997) 385-408.</p>
<p class=MsoNormal style='text-align:justify'>[2] Morh&#269; M., Matouek V.,
Kliman J., Efficient algorithm of multidimensional deconvolution and its
application to nuclear data processing, Digital Signal Processing 13 (2003)
144. </p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal><i>Example 1  script Decon.c :</i></p>
<p class=MsoNormal style='margin-left:36.0pt;text-align:justify;text-indent:
-18.0pt'><span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>response function (usually peak) should be shifted to the beginning of
the coordinate system (see Fig. 1)</p>
<p class=MsoNormal style='text-align:justify'><b><span style='font-size:16.0pt'><img
border=0 width=601 height=368 src="gif/spectrum3_deconvolution_image003.jpg"></span></b></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 1 Three-dimensional
response spectrum</b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><img border=0 width=601 height=368
src="gif/spectrum3_deconvolution_image004.jpg"></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 2 Three-dimensional input
spectrum (before deconvolution)</b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><img border=0 width=601 height=368
src="gif/spectrum3_deconvolution_image005.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 3 Spectrum from Fig. 2
after deconvolution (100 iterations)</b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><span style='color:#339966'>Script:</span></b></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// Example to illustrate the
Gold deconvolution (class TSpectrum3).</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// To execute this example,
do</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// root &gt; .x Decon3.C</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>#include &lt;TSpectrum3&gt;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>&nbsp;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>void Decon3() {</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Int_t i, j, k;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span><span lang=FR
style='font-size:10.0pt'>Int_t nbinsx = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsy = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsz =
32; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmax =
nbinsx;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymax =
nbinsy; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t zmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>Int_t zmax = nbinsz; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** source = new
float **[nbinsx];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** resp = new float
**[nbinsx]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j]=new
float [nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> resp[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> resp[i][j]=new float
[nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *decon_in = new
TH3F(&quot;decon_in&quot;,&quot;Deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *decon_resp = new
TH3F(&quot;decon_resp&quot;,&quot;Deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);
</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TFile *f = new
TFile(&quot;TSpectrum3.root&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> decon_in=(TH3F*)
f-&gt;Get(&quot;decon_in;1&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> decon_resp=(TH3F*)
f-&gt;Get(&quot;decon_resp;1&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TCanvas *Deconvolution =
new TCanvas(&quot;Deconvolution&quot;,&quot;Deconvolution of 3-dimensional
spectra&quot;,10,10,1000,700);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TSpectrum3 *s = new
TSpectrum3();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  for (k = 0;
k &lt; nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  source[i][j][k]
= decon_in-&gt;GetBinContent(i + 1,j + 1,k + 1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  resp[i][j][k]
= decon_resp-&gt;GetBinContent(i + 1,j + 1,k + 1);  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
s-&gt;Deconvolution(source,resp,nbinsx,nbinsy,nbinsz,100,1,1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
decon_in-&gt;SetBinContent(i + 1,j + 1,k + 1, source[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal> decon_in-&gt;Draw(&quot;&quot;); </p>
<p class=MsoNormal>}</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i>Example 2  script Decon_hr.c :</i></p>
<p class=MsoNormal style='text-align:justify'>This example illustrates repeated
Gold deconvolution with boosting. After every 10 iterations we apply power
function with exponent = 2 to the spectrum given in Fig. 2.</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><img border=0 width=601
height=368 src="gif/spectrum3_deconvolution_image006.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 4 Spectrum from Fig. 2
after boosted deconvolution (10 iterations repeated 10 times). It decomposes
completely cluster of peaks from Fig 2.</b></p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal><b><span style='color:#339966'>Script:</span></b></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// Example to illustrate the
Gold deconvolution (class TSpectrum3).</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// To execute this example,
do</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// root &gt; .x Decon3_hr.C</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>void Decon3_hr() {</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Int_t i, j, k;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span><span lang=FR
style='font-size:10.0pt'>Int_t nbinsx = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsy = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsz =
32; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmax =
nbinsx;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymax =
nbinsy; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t zmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>Int_t zmax = nbinsz; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** source = new
float **[nbinsx];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** resp = new float
**[nbinsx]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j]=new
float [nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> resp[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> resp[i][j]=new float
[nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *decon_in = new
TH3F(&quot;decon_in&quot;,&quot;Deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *decon_resp = new
TH3F(&quot;decon_resp&quot;,&quot;Deconvolution&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);
</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TFile *f = new
TFile(&quot;TSpectrum3.root&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> decon_in=(TH3F*)
f-&gt;Get(&quot;decon_in;1&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> decon_resp=(TH3F*)
f-&gt;Get(&quot;decon_resp;1&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TCanvas *Deconvolution =
new TCanvas(&quot;Deconvolution&quot;,&quot;High resolution deconvolution of
3-dimensional spectra&quot;,10,10,1000,700);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TSpectrum3 *s = new
TSpectrum3();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  for (k = 0;
k &lt; nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  source[i][j][k]
= decon_in-&gt;GetBinContent(i + 1,j + 1,k + 1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  resp[i][j][k]
= decon_resp-&gt;GetBinContent(i + 1,j + 1,k + 1);  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
s-&gt;Deconvolution(source,resp,nbinsx,nbinsy,nbinsz,10,10,2);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
decon_in-&gt;SetBinContent(i + 1,j + 1,k + 1, source[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
decon_in-&gt;Draw(&quot;&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>}</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'><span style='font-size:16.0pt'>&nbsp;</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum3:SearchHighRes" href="src/TSpectrum3.cxx.html#TT4IdE">SearchHighRes</a>(<span class="keyword">const</span> <span class="keyword">float</span>*** source, <span class="keyword">float</span>*** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> backgroundRemove, <a href="./ListOfTypes.html#Int_t">Int_t</a> deconIterations, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</span><br />
<div class="funccomm"><pre>
THREE-DIMENSIONAL HIGH-RESOLUTION PEAK SEARCH FUNCTION
This function searches for peaks in source spectrum
It is based on deconvolution method. First the background is
removed (if desired), then Markov spectrum is calculated
(if desired), then the response function is generated
according to given sigma and deconvolution is carried out.
It returns number of found peaks.

Function parameters:
source-pointer to the matrix of source spectrum
dest-pointer to the matrix of resulting deconvolved spectrum
ssizex-x length of source spectrum
ssizey-y length of source spectrum
ssizez-z length of source spectrum
sigma-sigma of searched peaks, for details we refer to manual
threshold-threshold value in % for selected peaks, peaks with
amplitude less than threshold*highest_peak/100
are ignored, see manual
backgroundRemove-logical variable, set if the removal of
background before deconvolution is desired
deconIterations-number of iterations in deconvolution operation
markov-logical variable, if it is <a href="./ListOfTypes.html#bool">true</a>, first the source spectrum
is replaced by new spectrum calculated using Markov
chains method.
averWindow-averanging window of searched peaks, for details
we refer to manual (applies only for Markov method)



</pre><!-- TDocHtmlDirective start --> <!--
/* -->
<div class=Section4>
<p class=MsoNormal><b><span style='font-size:14.0pt'>Peaks searching</span></b></p>
<p class=MsoNormal style='text-align:justify'><i>&nbsp;</i></p>
<p class=MsoNormal style='text-align:justify'><i>Goal: to identify
automatically the peaks in spectrum with the presence of the continuous
background, one- and two-fold coincidences (ridges) and statistical
fluctuations - noise.</i> </p>
<p class=MsoNormal><span style='font-family:Arial'>&nbsp;</span></p>
<p class=MsoNormal style='text-align:justify'>The common problems connected
with correct peak identification in three-dimensional coincidence spectra are</p>
<ul style='margin-top:0mm' type=disc>
 <li class=MsoNormal style='text-align:justify'>non-sensitivity to noise, i.e.,
     only statistically relevant peaks should be identified</li>
 <li class=MsoNormal style='text-align:justify'>non-sensitivity of the
     algorithm to continuous background</li>
 <li class=MsoNormal style='text-align:justify'>non-sensitivity to one-fold coincidences
     (coincidences peak  peak  background in all dimensions) and their
     crossings</li>
 <li class=MsoNormal style='text-align:justify'>non-sensitivity to two-fold
     coincidences (coincidences peak  background  background in all
     dimensions) and their crossings</li>
 <li class=MsoNormal style='text-align:justify'>ability to identify peaks close
     to the edges of the spectrum region</li>
 <li class=MsoNormal style='text-align:justify'>resolution, decomposition of
     doublets and multiplets. The algorithm should be able to recognize close
     positioned peaks. </li>
</ul>
<p class=MsoNormal><i>&nbsp;</i></p>
<p class=MsoNormal><i>Function:</i></p>
<p class=MsoNormal style='text-align:justify'><b><a
href="http://root.cern.ch/root/html/ListOfTypes.html#Int_t">Int_t</a> </b><a
name="TSpectrum:Search1HighRes"></a><a
href="http://root.cern.ch/root/html/TSpectrum.html#TSpectrum:Fit1Awmi"><b>TSpectrum3::SearchHighRes</b></a><b>
(const <a href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a>
***fSource,<a href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a>
***fDest, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizex, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizey, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fSizez, <a href="http://root.cern.ch/root/html/ListOfTypes.html#float">float</a>
fSigma, <a href="http://root.cern.ch/root/html/ListOfTypes.html#double">double</a>
fThreshold, <a href="http://root.cern.ch/root/html/ListOfTypes.html#bool">bool</a>
fBackgroundRemove,<a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fDeconIterations, <a href="http://root.cern.ch/root/html/ListOfTypes.html#bool">bool</a>
fMarkov, <a href="http://root.cern.ch/root/html/ListOfTypes.html#int">int</a>
fAverWindow) </b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'>This function searches for peaks
in source spectrum. It is based on deconvolution method. First the background
is removed (if desired), then Markov smoothed spectrum is calculated (if
desired), then the response function is generated according to given sigma and
deconvolution is carried out. On success it returns number of found peaks.</p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><i><span style='color:red'>Parameters:</span></i></p>
<p class=MsoNormal style='text-align:justify'> <b>fSource</b>-pointer to
the matrix of source spectrum </p>
<p class=MsoNormal style='text-align:justify'> <b>fDest</b>-resulting
spectrum after deconvolution</p>
<p class=MsoNormal style='text-align:justify'> <b>fSizex, fSizey, fSizez</b>
-lengths of the source and destination spectra </p>
<p class=MsoNormal style='text-align:justify'> <b>fSigma</b>-sigma of
searched peaks</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b>fThreshold</b>-
threshold value in % for selected peaks, peaks with amplitude less than
threshold*highest_peak/100 are ignored</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b>fBackgroundRemove</b>-
background_remove-logical variable, true if the removal of background before
deconvolution is desired </p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b>fDeconIterations</b>-number
of iterations in deconvolution operation</p>
<p class=MsoNormal style='margin-left:22.8pt;text-align:justify'><b>fMarkov</b>-logical
variable, if it is true, first the source spectrum is replaced by new spectrum
calculated using Markov chains method </p>
<p class=MsoNormal style='margin-left:19.95pt;text-align:justify;text-indent:
2.85pt'><b>fAverWindow</b>-width of averaging smoothing window </p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><b><i>References:</i></b></p>
<p class=MsoNormal style='text-align:justify'>[1] M.A. Mariscotti: A method for
identification of peaks in the presence of background and its application to
spectrum analysis. NIM 50 (1967), 309-320.</p>
<p class=MsoNormal style='text-align:justify'>[2] <span lang=SK>M.
Morh&#269;, J. Kliman, V. Matouek, M. Veselsk, I. Turzo</span>.:Identification
of peaks in multidimensional coincidence gamma-ray spectra. NIM, A443 (2000)
108-125.</p>
<p class=MsoNormal style='text-align:justify'>[3] Z.K. Silagadze, A new
algorithm for automatic photopeak searches. NIM A 376 (1996), 451.</p>
<p class=MsoNormal style='text-align:justify'>&nbsp;</p>
<p class=MsoNormal><b>Example of peak searching method</b></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal style='text-align:justify'><a
href="http://root.cern.ch/root/html/src/TSpectrum.cxx.html#TSpectrum:Search1HighRes"
target="_parent">SearchHighRes</a> function provides users with the possibility
to vary the input parameters and with the access to the output deconvolved data
in the destination spectrum. Based on the output data one can tune the
parameters. </p>
<p class=MsoNormal><i>Example 1  script Search3.c:</i></p>
<p class=MsoNormal>&nbsp;</p>
<p class=MsoNormal><img border=0 width=601 height=368
src="gif/spectrum3_searching_image001.jpg"></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 1 Three-dimensional
spectrum with 5 peaks (<sub><img border=0 width=40 height=19
src="gif/spectrum3_searching_image002.gif"></sub>, threshold=5%, 3 iterations steps in
the deconvolution)</b></p>
<p class=MsoNormal style='text-align:justify'><b>&nbsp;</b></p>
<p class=MsoNormal style='text-align:justify'><b><img border=0 width=601
height=368 src="gif/spectrum3_searching_image003.jpg"></b></p>
<p class=MsoNormal style='text-align:justify'><b>Fig. 2 Spectrum from Fig. 1
after background elimination and deconvolution</b></p>
<p class=MsoNormal><b><span style='color:#339966'>&nbsp;</span></b></p>
<p class=MsoNormal><b><span style='color:#339966'>Script:</span></b></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// Example to illustrate high
resolution peak searching function (class TSpectrum3).</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// To execute this example,
do</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>// root &gt; .x Search3.C</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>void Search3() {</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Int_t i, j, k, nfound;</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> </span><span lang=FR
style='font-size:10.0pt'>Int_t nbinsx = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsy = 32;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t nbinsz =
32; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t xmax =
nbinsx;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t ymax =
nbinsy; </span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> Int_t zmin = 0;</span></p>
<p class=MsoNormal><span lang=FR style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>Int_t zmax = nbinsz; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** source = new
float **[nbinsx];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> float *** dest = new float
**[nbinsx]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> source[i][j]=new
float [nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nbinsx;i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> dest[i]=new float*
[nbinsy];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
for(j=0;j&lt;nbinsy;j++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> dest[i][j]=new float
[nbinsz];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }  </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TH3F *search = new
TH3F(&quot;Search&quot;,&quot;Peak
searching&quot;,nbinsx,xmin,xmax,nbinsy,ymin,ymax,nbinsz,zmin,zmax);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TFile *f = new
TFile(&quot;TSpectrum3.root&quot;);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> search=(TH3F*)
f-&gt;Get(&quot;search2;1&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TCanvas *Search = new
TCanvas(&quot;Search&quot;,&quot;Peak searching&quot;,10,10,1000,700);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> TSpectrum3 *s = new
TSpectrum3();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  for (k = 0;
k &lt; nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  source[i][j][k]
= search-&gt;GetBinContent(i + 1,j + 1,k + 1);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> nfound =
s-&gt;SearchHighRes(source, dest, nbinsx, nbinsy, nbinsz, 2, 5, kTRUE, 3,
kFALSE, 3); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> printf(&quot;Found %d
candidate peaks\n&quot;,nfound); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (i = 0; i &lt; nbinsx;
i++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (j = 0; j &lt;
nbinsy; j++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for (k = 0; k &lt;
nbinsz; k++){</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>
search-&gt;SetBinContent(i + 1,j + 1,k + 1, dest[i][j][k]);</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> } </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> }</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Float_t *PosX = new
Float_t[nfound]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Float_t *PosY = new
Float_t[nfound];</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> Float_t *PosZ = new
Float_t[nfound]; </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> PosX =
s-&gt;GetPositionX();</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> PosY =
s-&gt;GetPositionY(); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> PosZ =
s-&gt;GetPositionZ(); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'> for(i=0;i&lt;nfound;i++)</span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>  </span><span
lang=PL style='font-size:10.0pt'>printf(&quot;posx= %d, posy= %d, posz=
%d\n&quot;,(int)(PosX[i]+0.5), (int)(PosY[i]+0.5),
(int)(PosZ[i]+0.5)); </span></p>
<p class=MsoNormal><span lang=PL style='font-size:10.0pt'> </span><span
style='font-size:10.0pt'>search-&gt;Draw(&quot;&quot;); </span></p>
<p class=MsoNormal><span style='font-size:10.0pt'>}</span></p>
</div>
<!-- */
 --> 
<!-- TDocHtmlDirective end --><pre>
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum3:SearchFast" href="src/TSpectrum3.cxx.html#t2GIWC">SearchFast</a>(<span class="keyword">const</span> <span class="keyword">float</span>*** source, <span class="keyword">float</span>*** dest, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizex, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizey, <a href="./ListOfTypes.html#Int_t">Int_t</a> ssizez, <a href="./ListOfTypes.html#Double_t">Double_t</a> sigma, <a href="./ListOfTypes.html#Double_t">Double_t</a> threshold, <a href="./ListOfTypes.html#Bool_t">Bool_t</a> markov, <a href="./ListOfTypes.html#Int_t">Int_t</a> averWindow)</span><br />
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="TSpectrum3:TSpectrum3" href="src/TSpectrum3.h.html#PdBTzD">TSpectrum3</a>()</span><br />
</div>
<div class="funcdoc"><span class="funcname"><a href="./TH1.html">TH1</a>                * <a class="funcname" name="TSpectrum3:GetHistogram" href="src/TSpectrum3.h.html#TsBn_C">GetHistogram</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum3.html#TSpectrum3:fHistogram" title="TH1* TSpectrum3::fHistogram">fHistogram</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Int_t">Int_t</a> <a class="funcname" name="TSpectrum3:GetNPeaks" href="src/TSpectrum3.h.html#PAya">GetNPeaks</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum3.html#TSpectrum3:fNPeaks" title="Int_t TSpectrum3::fNPeaks">fNPeaks</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Float_t">Float_t</a>            * <a class="funcname" name="TSpectrum3:GetPositionX" href="src/TSpectrum3.h.html#XhuWmD">GetPositionX</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum3.html#TSpectrum3:fPositionX" title="Float_t* TSpectrum3::fPositionX">fPositionX</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Float_t">Float_t</a>            * <a class="funcname" name="TSpectrum3:GetPositionY" href="src/TSpectrum3.h.html#eX4MmD">GetPositionY</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum3.html#TSpectrum3:fPositionY" title="Float_t* TSpectrum3::fPositionY">fPositionY</a>;}</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ListOfTypes.html#Float_t">Float_t</a>            * <a class="funcname" name="TSpectrum3:GetPositionZ" href="src/TSpectrum3.h.html#F1aqmD">GetPositionZ</a>() const</span><br />

<div class="code"><code class="inlinecode">{<span class="keyword">return</span> <a href="./TSpectrum3.html#TSpectrum3:fPositionZ" title="Float_t* TSpectrum3::fPositionZ">fPositionZ</a>;}</code></div>
<div style="clear:both;"></div>
</div>

<br />
<!--SIGNATURE-->
<div id="footer">
<em>&raquo; Author: <a href="http://consult.cern.ch/xwho/people?Miroslav+Morhac"> Miroslav Morhac   25/09/2006</a> </em><em>&raquo; Copyright   (C) 1995-2006, Rene Brun and Fons Rademakers.               *</em><br />
<em>&raquo; Last changed: root/spectrum:$Id: TSpectrum3.h 20882 2007-11-19 11:31:26Z rdm $ </em><em>&raquo; Last generated: 2011-11-03 20:23</em><br />
<em>This page has been automatically generated. For comments or suggestions regarding the documentation or ROOT in general please send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>.</em>
</div>
</div>
</body>
</html>
