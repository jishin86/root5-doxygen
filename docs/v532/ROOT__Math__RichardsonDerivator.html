<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!--                                             -->
<!-- Author: ROOT team (rootdev@pcroot.cern.ch)  -->
<!--                                             -->
<!--   Date: Thu Nov  3 20:05:18 2011            -->
<!--                                             -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>ROOT::Math::RichardsonDerivator</title>
<meta name="rating" content="General" />
<meta name="objecttype" content="Manual" />
<meta name="keywords" content="software development, oo, object oriented, unix, x11, windows, c++, html, rene brun, fons rademakers, cern" />
<meta name="description" content="ROOT - An Object Oriented Framework For Large Scale Data Analysis." />
<link rel="stylesheet" type="text/css" href="ROOT.css" id="ROOTstyle" />
<script type="text/javascript" src="ROOT.js"></script>
</head>
<body  onload="javascript:SetValuesFromCookie();"><div id="body_content">
<div id="root_header"><img src="http://root.cern.ch/drupal/sites/default/files/rootdrawing-logo.png" alt="ROOT logo"/></div>
<a name="TopOfPage"></a>
<script type="text/javascript">WriteFollowPageBox('class ROOT::Math::RichardsonDerivator','libMathCore','Math/RichardsonDerivator.h');</script>
<div id="toplinks">
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Quick Links:</span>
<a class="descrheadentry" href="http://root.cern.ch">ROOT Homepage</a>
<a class="descrheadentry" href="./ClassIndex.html">Class Index</a>
<a class="descrheadentry" href="./ClassHierarchy.html">Class Hierarchy</a></div>
<script type="text/javascript">
function onSearch() {
var s='http://www.google.com/search?q=%s+site%3A%u+-site%3A%u%2Fsrc%2F+-site%3A%u%2Fexamples%2F';
var ref=String(document.location.href).replace(/https?:\/\//,'').replace(/\/[^\/]*$/,'').replace(/\//g,'%2F');
window.location.href=s.replace(/%u/ig,ref).replace(/%s/ig,escape(document.searchform.t.value));
return false;}
</script>
<form id="searchform" name="searchform" onsubmit="return onSearch()" action="javascript:onSearch();" method="post">
<input name="t" size="30" value="Search documentation..." onfocus="if (document.searchform.t.value=='Search documentation...') document.searchform.t.value='';"></input>
<a id="searchlink"  title="www.google.com"  href="javascript:onSearch();" onclick="return onSearch()">Search</a></form>
</div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Source:</span>
<a class="descrheadentry" href="src/ROOT__Math__RichardsonDerivator.h.html">header file</a>
<a class="descrheadentry"> </a>
<a class="descrheadentry" href="http://root.cern.ch/viewcvs/trunk/mathcore/inc/Math/RichardsonDerivator.h?view=log">viewVC header</a> <a class="descrheadentry"> </a> 
</div></div>
<div class="descrhead"><div class="descrheadcontent">
<span class="descrtitle">Sections:</span>
<a class="descrheadentry" href="#ROOT__Math__RichardsonDerivator:description">class description</a> 
<a class="descrheadentry" href="#ROOT__Math__RichardsonDerivator:Function_Members">function members</a>
<a class="descrheadentry" href="#ROOT__Math__RichardsonDerivator:Data_Members">data members</a>
<a class="descrheadentry" href="#ROOT__Math__RichardsonDerivator:Class_Charts">class charts</a>
</div></div>
</div>
<div class="location">
<a class="locationlevel" href="index.html">ROOT</a>
 &#187; <a class="locationlevel" href="./MATH_Index.html">MATH</a>
 &#187; <a class="locationlevel" href="./MATH_MATHCORE_Index.html">MATHCORE</a>
 &#187; <a class="locationlevel" href="#TopOfPage">ROOT::Math::RichardsonDerivator</a>
</div>
<div class="dropshadow"><div class="withshadow"><h1><a name="ROOT__Math__RichardsonDerivator:description"></a>class ROOT::Math::RichardsonDerivator</h1>
<div class="classdescr">
<pre>

   User class for calculating the derivatives of a function. It can calculate first (method <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:Derivative1" title="double ROOT::Math::RichardsonDerivator::Derivative1(double x) or overloads">Derivative1</a>),
   second (method <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:Derivative2" title="double ROOT::Math::RichardsonDerivator::Derivative2(double x) or overloads">Derivative2</a>) and third (method <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:Derivative3" title="double ROOT::Math::RichardsonDerivator::Derivative3(double x) or overloads">Derivative3</a>) of a function.

   It uses the Richardson extrapolation method for function derivation in a given interval.
   The method use 2 derivative estimates (one computed with step h and one computed with step h/2)
   to compute a third, more accurate estimation. It is equivalent to the
   &lt;a href = http://en.wikipedia.org/wiki/Five-point_stencil&gt;5-point method&lt;/a&gt;,
   which can be obtained with a Taylor expansion.
   A step size should be given, depending on x and f(x).
   An optimal step size value minimizes the truncation error of the expansion and the rounding
   error in evaluating x+h and f(x+h). A too small h will yield a too large rounding error while a too large
   h will give a large truncation error in the derivative approximation.
   A good discussion can be found in discussed in
   &lt;a href=http://www.nrbook.com/a/bookcpdf/c5-7.pdf&gt;Chapter 5.7&lt;/a&gt;  of Numerical Recipes in C.
   By default a value of 0.001 is uses, acceptable in many cases.

   This class is implemented using code previosuly in  <a href="./TF1.html">TF1</a>::Derivate{,2,3}(). Now <a href="./TF1.html">TF1</a> uses this class.

   @ingroup Deriv


</pre></div>
</div></div>

<div id="functions">
<h2><a id="ROOT__Math__RichardsonDerivator:Function_Members"></a>Function Members (Methods)</h2>
<div class="access" id="funcpubl"><b>public:</b>
<table class="func" id="tabfuncpubl" cellspacing="0">
<tr class="func"><td class="funcret"></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:_RichardsonDerivator">~RichardsonDerivator</a>()</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative1">Derivative1</a>(<span class="keyword">double</span> x)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative1%1">Derivative1</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative2">Derivative2</a>(<span class="keyword">double</span> x)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative2%1">Derivative2</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative3">Derivative3</a>(<span class="keyword">double</span> x)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Derivative3%1">Derivative3</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:Error">Error</a>() <span class="keyword">const</span></td></tr>
<tr class="func"><td class="funcret"><span class="keyword">double</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:operator()">operator()</a>(<span class="keyword">double</span> x)</td></tr>
<tr class="func"><td class="funcret"><a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a>&amp;</td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:operator_">operator=</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a>&amp; rhs)</td></tr>
<tr class="func"><td class="funcret"><a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:RichardsonDerivator">RichardsonDerivator</a>(<span class="keyword">double</span> h = 0.001)</td></tr>
<tr class="func"><td class="funcret"><a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:RichardsonDerivator%2">RichardsonDerivator</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a>&amp; rhs)</td></tr>
<tr class="func"><td class="funcret"><a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:RichardsonDerivator%1">RichardsonDerivator</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> h = 0.001, <span class="keyword">bool</span> copyFunc = <span class="keyword">false</span>)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:SetFunction">SetFunction</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f)</td></tr>
<tr class="func"><td class="funcret"><span class="keyword">void</span></td><td class="funcname"><a class="funcname" href="#ROOT__Math__RichardsonDerivator:SetStepSize">SetStepSize</a>(<span class="keyword">double</span> h)</td></tr>

</table></div>
</div>

<div id="datamembers">
<h2><a name="ROOT__Math__RichardsonDerivator:Data_Members"></a>Data Members</h2>
<div class="access" id="dataprot"><b>protected:</b>
<table class="data" id="tabdataprot" cellspacing="0">
<tr class="data"><td class="datatype"><span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>*</td><td class="dataname"><a name="ROOT__Math__RichardsonDerivator:fFunction"></a>fFunction</td><td class="datadesc">pointer to function</td></tr>
<tr class="data"><td class="datatype"><span class="keyword">bool</span></td><td class="dataname"><a name="ROOT__Math__RichardsonDerivator:fFunctionCopied"></a>fFunctionCopied</td><td class="datadesc">flag to control if function is copied in the class</td></tr>
<tr class="data"><td class="datatype"><span class="keyword">double</span></td><td class="dataname"><a name="ROOT__Math__RichardsonDerivator:fLastError"></a>fLastError</td><td class="datadesc">error estimate of last derivative calculation</td></tr>
<tr class="data"><td class="datatype"><span class="keyword">double</span></td><td class="dataname"><a name="ROOT__Math__RichardsonDerivator:fStepSize"></a>fStepSize</td><td class="datadesc">step size used for derivative calculation</td></tr>

</table></div>
</div>
<h2><a id="ROOT__Math__RichardsonDerivator:Class_Charts"></a>Class Charts</h2>
<map name="MapROOT__Math__RichardsonDerivator_Lib" id="MapROOT__Math__RichardsonDerivator_Lib">
<area shape="rect" href="LibraryDependencies.html" title="All Libraries" alt="" coords="444,44,572,92"/>
</map>
<div class="tabs">
<a id="imgROOT__Math__RichardsonDerivator_Inh" class="tabsel" href="inh/ROOT__Math__RichardsonDerivator_Inh.png" onclick="javascript:return SetImg('Charts','inh/ROOT__Math__RichardsonDerivator_Inh.png');">Inheritance</a>
<a id="imgROOT__Math__RichardsonDerivator_InhMem" class="tab" href="inhmem/ROOT__Math__RichardsonDerivator_InhMem.png" onclick="javascript:return SetImg('Charts','inhmem/ROOT__Math__RichardsonDerivator_InhMem.png');">Inherited Members</a>
<a id="imgROOT__Math__RichardsonDerivator_Incl" class="tab" href="incl/ROOT__Math__RichardsonDerivator_Incl.png" onclick="javascript:return SetImg('Charts','incl/ROOT__Math__RichardsonDerivator_Incl.png');">Includes</a>
<a id="imgROOT__Math__RichardsonDerivator_Lib" class="tab" href="lib/ROOT__Math__RichardsonDerivator_Lib.png" onclick="javascript:return SetImg('Charts','lib/ROOT__Math__RichardsonDerivator_Lib.png');">Libraries</a><br/>
</div><div class="classcharts"><div class="classchartswidth"></div>
<img id="Charts" alt="Class Charts" class="classcharts" usemap="#MapROOT__Math__RichardsonDerivator_Inh" src="inh/ROOT__Math__RichardsonDerivator_Inh.png"/></div>
<h2>Function documentation</h2>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="ROOT__Math__RichardsonDerivator:_RichardsonDerivator" href="src/ROOT__Math__RichardsonDerivator.h.html#AbKuuE">~RichardsonDerivator</a>()</span><br />
<div class="funccomm"><pre> Destructor: Removes function if needed. 
</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="ROOT__Math__RichardsonDerivator:RichardsonDerivator" href="src/ROOT__Math__RichardsonDerivator.h.html#B7fc9">RichardsonDerivator</a>(<span class="keyword">double</span> h = 0.001)</span><br />
<div class="funccomm"><pre> Default Constructor.
       Give optionally the step size for derivation. By default is 0.001, which is fine for x ~ 1
       Increase if x is in averga larger or decrease if x is smaller

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="ROOT__Math__RichardsonDerivator:RichardsonDerivator%1" href="src/ROOT__Math__RichardsonDerivator.h.html#VZYjVE">RichardsonDerivator</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> h = 0.001, <span class="keyword">bool</span> copyFunc = <span class="keyword">false</span>)</span><br />
<div class="funccomm"><pre> Construct from function and step size

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"> <a class="funcname" name="ROOT__Math__RichardsonDerivator:RichardsonDerivator%2" href="src/ROOT__Math__RichardsonDerivator.h.html#if6r0E">RichardsonDerivator</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a>&amp; rhs)</span><br />
<div class="funccomm"><pre>
      Copy constructor

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:RichardsonDerivator" title="ROOT::Math::RichardsonDerivator ROOT::Math::RichardsonDerivator::RichardsonDerivator(double h=0.001) or overloads">RichardsonDerivator</a> &amp; <a class="funcname" name="ROOT__Math__RichardsonDerivator:operator_" href="src/ROOT__Math__RichardsonDerivator.h.html#EAOq4D">operator=</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__RichardsonDerivator.html">RichardsonDerivator</a>&amp; rhs)</span><br />
<div class="funccomm"><pre>
      Assignment operator

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Error" href="src/ROOT__Math__RichardsonDerivator.h.html#QXuRUD">Error</a>() const</span><br />
<div class="funccomm"><pre> Returns the estimate of the absolute <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:Error" title="double ROOT::Math::RichardsonDerivator::Error()">Error</a> of the last derivative calculation. 
</pre></div>

<div class="code"><code class="inlinecode">{  <span class="keyword">return</span> <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:fLastError" title="double ROOT::Math::RichardsonDerivator::fLastError">fLastError</a>; }</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative1" href="src/ROOT__Math__RichardsonDerivator.h.html#mAt0XB">Derivative1</a>(<span class="keyword">double</span> x)</span><br />
<div class="funccomm"><pre>
      Returns the first derivative of the function at point x,
      computed by Richardson's extrapolation method (use 2 derivative estimates
      to compute a third, more accurate estimation)
      first, derivatives with steps h and h/2 are computed by central difference formulas

<span class="latex"><img class="latex" alt="D(h) = #frac{f(x+h) - f(x-h)}{2h}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Error_1_0_Dhfracfxhfxhh.gif" /></span>
      the final estimate <span class="latex"><img class="latex" alt="D = #frac{4D(h/2) - D(h)}{3}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Error_1_1_DfracDhDh.gif" /></span>
       <span class="string">"Numerical Methods for Scientists and Engineers"</span>, H.M.Antia, 2nd edition<span class="string">"</span>

      the argument eps may be specified to control the step size (precision).
      the step size is taken as eps*(xmax-xmin).
      the default value (0.001) should be good enough for the vast majority
      of functions. Give a smaller value if your function has many changes
      of the second derivative in the function range.

      Getting the error via <a href="./TF1.html">TF1</a>::<a href="./TF1.html#TF1:DerivativeError" title="Double_t TF1::DerivativeError()">DerivativeError</a>:
        (total error = roundoff error + interpolation error)
      the estimate of the roundoff error is taken as follows:

<span class="latex"><img class="latex" alt="err = k#sqrt{f(x)^{2} + x^{2}deriv^{2}}#sqrt{#sum ai^{2}}," title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Error_1_2_errksqrtfxxderivsqrtsumai.gif" /></span>
      where k is the <a href="./ListOfTypes.html#double">double</a> precision, ai are coefficients used in
      central difference formulas
      interpolation error is decreased by making the step size h smaller.

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:operator()" href="src/ROOT__Math__RichardsonDerivator.h.html#ZulAGB">operator()</a>(<span class="keyword">double</span> x)</span><br />

<div class="code"><code class="inlinecode">{ <span class="keyword">return</span> <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:Derivative1" title="double ROOT::Math::RichardsonDerivator::Derivative1(double x) or overloads">Derivative1</a>(x); }</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative1%1" href="src/ROOT__Math__RichardsonDerivator.h.html#r7DcZC">Derivative1</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</span><br />
<div class="funccomm"><pre>
      First Derivative calculation passing function and step-size

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative2" href="src/ROOT__Math__RichardsonDerivator.h.html#SZUNXB">Derivative2</a>(<span class="keyword">double</span> x)</span><br />
<div class="funccomm"><pre>
      Returns the second derivative of the function at point x,
      computed by Richardson's extrapolation method (use 2 derivative estimates
      to compute a third, more accurate estimation)
      first, derivatives with steps h and h/2 are computed by central difference formulas

<span class="latex"><img class="latex" alt="D(h) = #frac{f(x+h) - 2f(x) + f(x-h)}{h^{2}}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative1_1_0_Dhfracfxhfxfxhh.gif" /></span>
      the final estimate <span class="latex"><img class="latex" alt="D = #frac{4D(h/2) - D(h)}{3}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative1_1_1_DfracDhDh.gif" /></span>
       <span class="string">"Numerical Methods for Scientists and Engineers"</span>, H.M.Antia, 2nd edition<span class="string">"</span>

      the argument eps may be specified to control the step size (precision).
      the step size is taken as eps*(xmax-xmin).
      the default value (0.001) should be good enough for the vast majority
      of functions. Give a smaller value if your function has many changes
      of the second derivative in the function range.

      Getting the error via <a href="./TF1.html">TF1</a>::<a href="./TF1.html#TF1:DerivativeError" title="Double_t TF1::DerivativeError()">DerivativeError</a>:
        (total error = roundoff error + interpolation error)
      the estimate of the roundoff error is taken as follows:

<span class="latex"><img class="latex" alt="err = k#sqrt{f(x)^{2} + x^{2}deriv^{2}}#sqrt{#sum ai^{2}}," title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative1_1_2_errksqrtfxxderivsqrtsumai.gif" /></span>
      where k is the <a href="./ListOfTypes.html#double">double</a> precision, ai are coefficients used in
      central difference formulas
      interpolation error is decreased by making the step size h smaller.

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative2%1" href="src/ROOT__Math__RichardsonDerivator.h.html#Oeh_2E">Derivative2</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</span><br />
<div class="funccomm"><pre>
      Second Derivative calculation passing function and step-size

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative3" href="src/ROOT__Math__RichardsonDerivator.h.html#yx7lWB">Derivative3</a>(<span class="keyword">double</span> x)</span><br />
<div class="funccomm"><pre>
      Returns the third derivative of the function at point x,
      computed by Richardson's extrapolation method (use 2 derivative estimates
      to compute a third, more accurate estimation)
      first, derivatives with steps h and h/2 are computed by central difference formulas

<span class="latex"><img class="latex" alt="D(h) = #frac{f(x+2h) - 2f(x+h) + 2f(x-h) - f(x-2h)}{2h^{3}}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative2_1_0_Dhfracfxhfxhfxhfxhh.gif" /></span>
      the final estimate <span class="latex"><img class="latex" alt="D = #frac{4D(h/2) - D(h)}{3}" title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative2_1_1_DfracDhDh.gif" /></span>
       <span class="string">"Numerical Methods for Scientists and Engineers"</span>, H.M.Antia, 2nd edition<span class="string">"</span>

      the argument eps may be specified to control the step size (precision).
      the step size is taken as eps*(xmax-xmin).
      the default value (0.001) should be good enough for the vast majority
      of functions. Give a smaller value if your function has many changes
      of the second derivative in the function range.

      Getting the error via <a href="./TF1.html">TF1</a>::<a href="./TF1.html#TF1:DerivativeError" title="Double_t TF1::DerivativeError()">DerivativeError</a>:
        (total error = roundoff error + interpolation error)
      the estimate of the roundoff error is taken as follows:

<span class="latex"><img class="latex" alt="err = k#sqrt{f(x)^{2} + x^{2}deriv^{2}}#sqrt{#sum ai^{2}}," title="LATEX" src="LATEX_ROOT__Math__RichardsonDerivator_Derivative2_1_2_errksqrtfxxderivsqrtsumai.gif" /></span>
      where k is the <a href="./ListOfTypes.html#double">double</a> precision, ai are coefficients used in
      central difference formulas
      interpolation error is decreased by making the step size h smaller.

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">double</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:Derivative3%1" href="src/ROOT__Math__RichardsonDerivator.h.html#q7DcZC">Derivative3</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f, <span class="keyword">double</span> x, <span class="keyword">double</span> h)</span><br />
<div class="funccomm"><pre>
      Third Derivative calculation passing function and step-size

</pre></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:SetFunction" href="src/ROOT__Math__RichardsonDerivator.h.html#xfWeRE">SetFunction</a>(<span class="keyword">const</span> <a href="./ROOT.html">ROOT</a>::<a href="./ROOT__Math.html">Math</a>::<a href="./ROOT__Math__IGenFunction.html">IGenFunction</a>&amp; f)</span><br />
<div class="funccomm"><pre> Set function for derivative calculation (function is not copied in)

       \@param f Function to be differentiated

</pre></div>

<div class="code"><code class="inlinecode">{ <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:fFunction" title="const ROOT::Math::IGenFunction* ROOT::Math::RichardsonDerivator::fFunction">fFunction</a> = &amp;f; }</code></div>
<div style="clear:both;"></div>
</div>
<div class="funcdoc"><span class="funcname"><span class="keyword">void</span> <a class="funcname" name="ROOT__Math__RichardsonDerivator:SetStepSize" href="src/ROOT__Math__RichardsonDerivator.h.html#WMBlFC">SetStepSize</a>(<span class="keyword">double</span> h)</span><br />
<div class="funccomm"><pre> Set step size for derivative calculation

       \@param h step size for calculation

</pre></div>

<div class="code"><code class="inlinecode">{ <a href="./ROOT__Math__RichardsonDerivator.html#ROOT__Math__RichardsonDerivator:fStepSize" title="double ROOT::Math::RichardsonDerivator::fStepSize">fStepSize</a> = h; }</code></div>
<div style="clear:both;"></div>
</div>

<br />
<!--SIGNATURE-->
<div id="footer">

<em>&raquo; Last changed: root/mathcore:$Id: RichardsonDerivator.h 24482 2008-06-23 15:33:08Z moneta $ </em><em>&raquo; Last generated: 2011-11-03 20:05</em><br />
<em>This page has been automatically generated. For comments or suggestions regarding the documentation or ROOT in general please send a mail to <a href="mailto:rootdev@root.cern.ch">ROOT support</a>.</em>
</div>
</div>
</body>
</html>
